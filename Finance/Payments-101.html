<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <meta name="author" content="Bhaskar.S">
    <meta name="description" content="Card and Mobile Payments Flow 101">
    <meta name="subject" content="Card and Mobile Payments Flow 101">
    <meta name="keywords" content="finance, general">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <title>Card and Mobile Payments Flow 101</title>
    <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br/>
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="gen-home"></span></td>
        <td valign="bottom"><span id="gen-home-a"><a id="gen-home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="gen-title-div">
      <p>Card and Mobile Payments Flow 101</p>
    </div>
    <br />
    <table id="gen-ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">08/10/2024</td>
        </tr>
      </tbody>
    </table>
    <hr class="gen-line-hr"/>
    <br/>
    <div id="para-div">
      <p>Know what exactly happens behind the scenes when a customer uses a physical <span class="bold">Card</span> (credit or debit)
        OR uses the <span class="bold">Mobile</span> device to make a purchase either online or at a store ???</p>
      <p>Not many understand how these payments work end to end, so thought would explain the high-level flows in very simple terms
        for the benefit of others. But, before we get started, wanted to make sure we are all on the same page with respect to some
        terminology related to the card payments.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Terminology</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following are the list of all the commonly used terminologies in the card payments:</p>
      <ul id="gen-sqr-ul">
        <li>
          <p><span class="hi-yellow">Merchant</span> is a business entity that provides good and services to a customer.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Acquirer</span> (or <span class="hi-vanila">Acquiring Bank</span>) is the financial institution
            (or bank) that collects and processes card transactions on behalf of a <span class="bold">Merchant</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Merchant Bank</span> is the financial institution that manages the bank account(s) on behalf of
            the <span class="bold">Merchant</span>. In most cases, the <span class="bold">Acquirer</span> would also be the <span
            class="bold">Merchant Bank</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Line of Credit</span> (or <span class="hi-vanila">LOC</span> for short) is the personal loan
            issued to a customer.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Issuer</span> (or <span class="hi-vanila">Issuing Bank</span>) is the financial institution (or
            bank) that provides the LOC and supplies a card to a customer.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Card Holder</span> is the customer with a card that is provided by the <span class="bold">Issuer
            </span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Point of Sale</span> (or <span class="hi-vanila">POS</span> for short) is the physical device
            at the <span class="bold">Merchant</span> where a card can be used by the <span class="bold">Card Holder</span> to make
            a purchase.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Network</span> (or <span class="hi-vanila">Card Network</span>) is the financial intermediary
            between the <span class="bold">Acquirer</span> and the <span class="bold">Issuer</span>. The major players are <span
            class="bold">Visa</span>, <span class="bold">Mastercard</span>, <span class="bold">Amex</span>, and <span class="bold">
            Discover</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Primary Account Number</span> (or <span class="hi-vanila">PAN</span> for short) is the full 16
            digit card number.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Bank Identification Number</span> (or <span class="hi-vanila">BIN</span> for short) is the first
            6 to 8 digits of the card number that identifies the <span class="bold">Issuer</span>. For <span class="bold">Visa</span>,
            the <span class="bold">BIN</span> starts with a <span class="hi-red">4</span>, for <span class="bold">Mastercard</span>
            the <span class="bold">BIN</span> starts with a <span class="hi-red">2</span> OR a <span class="hi-red">5</span>, etc.
            Every financial institution (or bank), be it an <span class="bold">Acquirer</span> or an <span class="bold">Issuer</span>,
            has its associated <span class="bold">BIN</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Card Security Code</span> (or <span class="hi-vanila">CSC</span> for short, also referred to as
            <span class="hi-yellow">Card Verification Value</span> or <span class="hi-vanila">CVV</span> for short) is the 3 to 5 digit
            numeric code on the back of the card.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Token</span> is a 16-digit alias corresponding to a card <span class="bold">PAN</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Tokenization</span> is the process of replacing the 16-digit card <span class="bold">PAN</span>
            with an alias <span class="bold">Token</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Wallet</span> is the mobile app that stores the 16-digit alias token corresponding to a card.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Token Service Provider</span> is another name for the <span class="hi-vanila">Network</span>.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Token Key</span> is the cryptographic key used to encrypt data.</p>
        </li>
        <li>
          <p><span class="hi-yellow">Cryptogram</span> is the encryption of the transaction date, the transaction amount, etc. by
            the <span class="bold">Wallet</span>.</p>
        </li>
      </ul>
    </div>
    <br/>
    <div id="section-div">
      <p>Card Payments</p>
    </div>
    <br/>
    <div id="para-div">
      <p>We will first focus on the card payments flow as it is foundational for the overall understanding.</p>
    </div>
    <div id="para-div">
      <p>At a high level, the following illustration depicts the involved entities in the card payment flow:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="High Level" class="gen-img-cls" src="./images/payments-1.png">
          <div class="gen-img-cap">Figure.1</div>
        </div>
      </div>
      <br/>
    </div>
    <br/>
    <div id="para-div">
      <p>The card payments flow goes through the following 3-steps before everything gets settled:</p>
        <ul id="gen-sqr-ul">
          <li><p>Authorization</p></li>
          <li><p>Batching</p></li>
          <li><p>Clearing and Settlement</p></li>
        </ul>
      <p>In the following paragraphs, we will unpack each of the 3-steps.</p>
    </div>
    <br/>
    <div id="step-div">
      <p>Step-1 =&gt; Authorization</p>
    </div>
    <br/>
    <div id="para-div">
      <p>A <span class="bold">Card Holder</span> wants to buy some goods from a <span class="bold">Merchant</span> who is having a
        great sale at their stores.</p>
    </div>
    <div id="para-div">
      <p>The following illustration depicts the card payment flow for the <span class="bold">Authorization</span> step:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="Authorization" class="gen-img-cls" src="./images/payments-2.png">
          <div class="gen-img-cap">Figure.2</div>
        </div>
      </div>
      <br/>
    </div>
    <br/>
    <div id="para-div">
      <p>Let us unpack each of the numbered arrows from the illustration in <span class="bold">Figure.2</span> as follows:</p>
      <ul id="gen-sqr-ul">
        <li><p><span class="hi-yellow">(A)</span> :: The <span class="bold">Card Holder</span> uses the card at the <span class=
          "bold">Merchant</span>'s POS terminal</p></li>
        <li><p><span class="hi-yellow">(1)</span> :: The <span class="bold">Merchant</span>'s POS terminal sends an <span class=
          "bold">Authorization</span> request containing a unique transaction id, the 16 digit card number, the card expiry, the
          CVV code, the merchant id, and the transaction amount to the <span class="bold">Acquirer</span></p></li>
        <li><p><span class="hi-yellow">(2)</span> :: The <span class="bold">Acquirer</span> looks at the card BIN and routes the
          request to the appropriate <span class="bold">Network</span></p></li>
        <li><p><span class="hi-yellow">(3)</span> :: The <span class="bold">Network</span> looks at the card BIN and routes the
          request to the appropriate card <span class="bold">Issuer</span></p></li>
        <li><p><span class="hi-yellow">(4)</span> :: The card <span class="bold">Issuer</span> performs various checks, such as
          is the card inactive, has the card expired, does the <span class="bold">Card Holder</span> have enough of remaining
          credit to fund the purchase, is the card transaction a fraud, etc. Based on the outcome of the checks, the <span class
          ="bold">Issuer</span> may approve or deny the request and send a response back to the <span class="bold">Network</span>.
          If approved, the <span class="bold">Issuer</span> places a hold for the transaction amount on the <span class="bold">
          Card Holder</span>'s credit account</p></li>
        <li><p><span class="hi-yellow">(5)</span> :: The <span class="bold">Network</span> looks at the <span class="bold">Acquirer
          </span> BIN and routes the response to the appropriate <span class="bold">Acquirer</span></p></li>
        <li><p><span class="hi-yellow">(6)</span> :: The <span class="bold">Acquirer</span> looks at the merchant id and routes
          the response to the appropriate <span class="bold">Merchant</span> POS</p></li>
      </ul>
    </div>
    <br/>
    <div id="step-div">
      <p>Step-2 =&gt; Batching</p>
    </div>
    <br/>
    <div id="para-div">
      <p>At the end of the business day, the <span class="bold">Merchant</span> needs to be paid for all the sale transactions.</p>
    </div>
    <div id="para-div">
      <p>The following illustration depicts the card payment flow for the <span class="bold">Batching</span> step:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="Batching" class="gen-img-cls" src="./images/payments-3.png">
          <div class="gen-img-cap">Figure.3</div>
        </div>
      </div>
      <br/>
    </div>
    <div id="para-div">
      <p>Let us unpack each of the numbered arrows from the illustration in <span class="bold">Figure.3</span> as follows:</p>
      <ul id="gen-sqr-ul">
        <li><p><span class="hi-yellow">(7)</span> :: The POS terminal at the <span class="bold">Merchant</span> batches all the
          approved card transactions at the end of the business day and sends them to the <span class="bold">Acquirer</span> for
          settlement</p></li>
        <li><p><span class="hi-yellow">(8)</span> :: The <span class="bold">Acquirer</span> forwards each of the approved card
          transactions to the appropriate <span class="bold">Network</span> based on the card BIN for clearing and settlement</p></li>
      </ul>
    </div>
    <br/>
    <div id="step-div">
      <p>Step-3 =&gt; Clearing and Settlement</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The <span class="bold">Merchant</span>'s account needs to be credited, while the <span class="bold">Card Holder</span>'s
        LOC needs to be debited.</p>
    </div>
    <div id="para-div">
      <p>The following illustration depicts the card payment flow for the <span class="bold">Clearing and Settlement</span> step:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="Settlement" class="gen-img-cls" src="./images/payments-4.png">
          <div class="gen-img-cap">Figure.4</div>
        </div>
      </div>
      <br/>
    </div>
    <div id="para-div">
      <p>Let us unpack each of the numbered arrows from the illustration in <span class="bold">Figure.4</span> as follows:</p>
      <ul id="gen-sqr-ul">
        <li><p><span class="hi-yellow">(9)</span> :: The <span class="bold">Network</span> batches all the transactions pertaining
          to an <span class="bold">Issuer</span> and dispatches them in bulk to the <span class="bold">Issuer</span> for clearing
          and settlement</p></li>
        <li><p><span class="hi-yellow">(10)</span> :: The <span class="bold">Issuer</span> validates all the approved <span class=
          "bold">Card Holder</span> transactions to ensure they match, accumulates the amount related to the <span class="bold">
          Acquirer</span>, and finally transfers the netted funds to the <span class="bold">Acquirer</span></p></li>
        <li><p><span class="hi-yellow">(11)</span> :: The <span class="bold">Acquirer</span> deposits all the funds related to the
          particular <span class="bold">Merchant</span> to the corresponding <span class="bold">Merchant Bank</span></p></li>
        <li><p><span class="hi-yellow">(B)</span> :: The <span class="bold">Card Holder</span> makes a payment at the end of the
          billing cycle to the <span class="bold">Issuer</span> clearing the balance</p></li>
      </ul>
    </div>
    <div id="para-div">
      <p>This in essence outlines the end-to-end card payment flow when a customer makes an online purchase OR swipes/taps the card
        at any store.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Mobile Payments</p>
    </div>
    <br/>
    <div id="para-div">
      <p>Shifting gears, we will first focus on the mobile payments flow as it builds on the card payment flows.</p>
    </div>
    <div id="para-div">
      <p>For mobile payments, one needs to first provision a card into a <span class="bold">Wallet</span> on the mobile device. The
        following illustration depicts the card provisioning flow:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="Provisioning" class="gen-img-cls" src="./images/payments-5.png">
          <div class="gen-img-cap">Figure.5</div>
        </div>
      </div>
      <br/>
    </div>
    <div id="para-div">
      <p>Let us unpack each of the numbered arrows from the illustration in <span class="bold">Figure.5</span> as follows:</p>
      <ul id="gen-sqr-ul">
        <li><p><span class="hi-yellow">(1)</span> :: When a <span class="bold">Card Holder</span> adds a card to the <span class=
          "bold">Wallet</span>, the mobile device sends the card details (the 16-digit PAN, the card expiration, etc) to the <span
          class="bold">Token Gateway Server</span> (referred to as the <span class="hi-vanila">Apple Pay Server</span> in the case
          of <span class="bold">Apple</span>)</p></li>
        <li><p><span class="hi-yellow">(2)</span> :: The <span class="bold">Token Gateway Server</span> looks at the card BIN and
          routes the request to the appropriate <span class="bold">Network</span> (referred to as the <span class="bold">Token
          Service Provider</span>)</p></li>
        <li><p><span class="hi-yellow">(3)</span> :: The <span class="bold">Network</span> looks at the card BIN and routes the
          request to the appropriate card <span class="bold">Issuer</span> for further verification</p></li>
        <li><p><span class="hi-yellow">(4)</span> :: The card <span class="bold">Issuer</span> performs various checks, such as
          is the card inactive, has the card expired, etc. Based on the outcome of the checks, the <span class="bold">Issuer</span>
          may approve or deny the request and send a response back to the <span class="bold">Network</span>. For approved requests,
          the <span class="bold">Issuer</span> adds an encrypted <span class="bold">CVV</span> and sends a response back to the
          <span class="bold">Network</span></p></li>
        <li><p><span class="hi-yellow">(5)</span> :: On approval response, the <span class="bold">Network</span> generates a <span
          class="bold">Token</span> AND a cryptographic <span class="bold">Token Key</span> for the corresponding card <span class
          ="bold">PAN</span> and sends them to the <span class="bold">Issuer</span></p></li>
        <li><p><span class="hi-yellow">(6)</span> :: For approved requests, the <span class="bold">Network</span> also sends the
          same <span class="bold">Token</span>, the <span class="bold">Token Key</span>, and the encrypted <span class="bold">
          CVV</span> to the <span class="bold">Token Gateway Server</span></p></li>
        <li><p><span class="hi-yellow">(7)</span> :: The <span class="bold">Token Gateway Server</span> sends the same <span class
          ="bold">Token</span>, the <span class="bold">Token Key</span>, and the encrypted <span class="bold">CVV</span> to the
          <span class="bold">Wallet</span> for safe storage in a secure area. The <span class="bold">Wallet</span> does not store
          the card <span class="bold">PAN</span></p></li>
      </ul>
    </div>
    <div id="para-div">
      <p>In the case of mobile payment, when a <span class="bold">Card Holder</span> uses the mobile device to buy some goods from
        a <span class="bold">Merchant</span>, there are minor tweaks to the <span class="bold">Authorization</span> step.</p>
    </div>
    <div id="para-div">
      <p>The following illustration depicts the mobile payment flow for the <span class="bold">Authorization</span> step:</p>
      <br/>
      <div id="para-div">
        <div id="gen-img-outer-div">
          <img alt="Mobile Authorization" class="gen-img-cls" src="./images/payments-6.png">
          <div class="gen-img-cap">Figure.6</div>
        </div>
      </div>
      <br/>
    </div>
    <br/>
    <div id="para-div">
      <p>Let us unpack each of the numbered arrows from the illustration in <span class="bold">Figure.6</span> as follows:</p>
      <ul id="gen-sqr-ul">
        <li><p><span class="hi-yellow">(A)</span> :: The <span class="bold">Card Holder</span> uses the mobile device at the <span
          class="bold">Merchant</span>'s POS terminal, which causes the mobile device to generate a <span class="bold">Cryptogram
          </span> based on a unique transaction id, the transaction date, the transaction amount, etc. and send to the <span class
          ="bold">Merchant</span>'s POS terminal</p></li>
        <li><p><span class="hi-yellow">(1)</span> :: The <span class="bold">Merchant</span>'s POS terminal sends an <span class=
          "bold">Authorization</span> request containing the <span class="bold">Cryptogram</span>, the 16 digit <span class="bold">
          Token</span>, the encrypted <span class="bold">CVV</span>, and the merchant id to the <span class="bold">Acquirer</span>
        </p></li>
        <li><p><span class="hi-yellow">(2)</span> :: The <span class="bold">Acquirer</span> looks at the <span class="bold">Token
          </span> BIN and routes the request to the appropriate <span class="bold">Network</span></p></li>
        <li><p><span class="hi-yellow">(3)</span> :: The <span class="bold">Network</span> looks up the card <span class="bold">PAN
          </span> corresponding to the <span class="bold">Token</span>, looks at the card BIN and routes the request (with the card
          <span class="bold">PAN</span>) to the appropriate card <span class="bold">Issuer</span></p></li>
          
        <li><p><span class="hi-yellow">(4)</span> :: The card <span class="bold">Issuer</span> decrypts the <span class="bold">
          Cryptogram</span> and performs various checks, such as is the card inactive, has the card expired, does the <span class
          ="bold">Card Holder</span> have enough of remaining credit to fund the purchase, is the card transaction a fraud, etc.
          Based on the outcome of the checks, the <span class="bold">Issuer</span> may approve or deny the request and send a
          response back to the <span class="bold">Network</span>. If approved, the <span class="bold">Issuer</span> places a hold
          for the transaction amount on the <span class="bold">Card Holder</span>'s credit account</p></li>
        <li><p><span class="hi-yellow">(5)</span> :: The <span class="bold">Network</span> looks at the <span class="bold">Acquirer
          </span> BIN and routes the response to the appropriate <span class="bold">Acquirer</span></p></li>
        <li><p><span class="hi-yellow">(6)</span> :: The <span class="bold">Acquirer</span> looks at the merchant id and routes
          the response to the appropriate <span class="bold">Merchant</span> POS</p></li>
      </ul>
    </div>
    <div id="para-div">
      <p>The remaining two steps (<span class="bold">Batching</span> and <span class="bold">Clearing and Settlement</span>) in the
        payment process for the mobile payments are the same as the card payments.</p>
    </div>
    <br/>
    <hr class="gen-line-hr" />
    <div>
      <a id="gen-footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
