<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
      <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
      <meta name="Building a ODroid N2 Cluster" content="author: Bhaskar.S, category: arm, linux">
      <title>Building a ODroid N2 Cluster</title>
      <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br/>
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Building a ODroid N2 Cluster</p>
    </div>
    <br />
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">04/26/2019</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" /> <br />
      <div id="section-div">
        <p>Part 1</p>
      </div>
    <div id="para-div">
      <p>In the article <a href="http://polarsparc.github.io/xhtml/XU4-Cluster.html" target="_blank"><span class="bold">
        Building a ODroid XU4 Cluster</span></a>, we laid out the ingredients to build a 5-node home lab cluster using
        the powerful 32-bit <span class="hi-yellow">ODroid XU4</span>'s. As was indicated, the <span class="bold">
        ODroid XU4</span> sports a powerful octa-core ARM-based Samsung Exynos5422 CPU with two sets of quad-cores (also
        referred to as the <span class="hi-yellow">big.LITTLE</span>) with Cortex A15 running at 2 Ghz and Cortex A7
        running at 1.4 Ghz. It has enough horsepower to run Linux and serve as a mini-development cluster. However, the
        <span class="bold">ODroid XU4</span> is a 32-bit <span class="bold">SBC</span> with 2GB of LPDDR3 on-board memory.</p>
      <p>In my quest for a true 64-bit quad-core <span class="bold">SBC</span> with each core close to 2 Ghz and with at
        least 4GB of RAM, came upon this newly released beauty called
        <a href="https://www.hardkernel.com/shop/odroid-n2-with-4gbyte-ram/" target="_blank"><span class="bold">
        ODroid N2 (4GB RAM)</span></a>. It sports a powerful hex-core ARM-based Amlogic 922X CPU with two sets of cores
        (also referred to as the <span class="hi-yellow">big.LITTLE</span>) with a quad-core Cortex A73 running at 1.8
        Ghz and a dual-core Cortex A53 running at 1.9 Ghz. In addition, it comes with a *<span class="bold">HUGE</span>*
        heatsink mounted on the bottom (where the CPU is located). It comes in two configurations, one with 2GB of DDR4 RAM
        and the other with 4GB of DDR4 RAM (running at 1320 Mhz). It has 4 USB 3.0 ports and a 1G ethernet port.</p>
      <p>The following are the necessary items needed to build a 5-node <span class="bold">ODroid N2</span> cluster:</p>
      <ul id="blue-sqr-ul">
        <li>
          <p>Five <a href="https://ameridroid.com/collections/single-board-computer/products/odroid-n2?variant=16034239447074"
            target="_blank"><span class="bold">ODroid N2</span></a> 4GB single-board computers</p>
          <div id="img-outer-div"> <img src="./images/n2-01.png" class="img-cls" alt="ODroid N2 4GB" />
            <div class="img-cap">Figure. 1</div>
          </div>
        </li>
        <li>
          <p>Five <a href="https://ameridroid.com/products/12v-2a-power-supply-plug" target="_blank"><span class="bold">12V/2A
            </span></a> power adapters</p>
          <div id="img-outer-div"> <img src="./images/n2-02.png" class="img-cls" alt="PowerAdapter" />
            <div class="img-cap">Figure. 2</div>
          </div>
        </li>
        <li>
          <p>Five <a href="https://www.amazon.com/gp/product/B073JYVKNX/" target="_blank"><span class="bold">Class 10
            64 GB</span></a> microSDXC cards</p>
          <div id="img-outer-div"> <img src="./images/rpc-03.png" class="img-cls" alt="MicroSDXC Card" />
            <div class="img-cap">Figure. 3</div>
          </div>
        </li>
        <li>
          <p>Five <a href="https://www.amazon.com/Cable-Matters-160021-Snagless-Ethernet/dp/B00E5I7VJG" target="_blank">
            <span class="bold">Ethernet</span></a> network cables</p>
          <div id="img-outer-div"> <img src="./images/rpc-04.png" class="img-cls" alt="Ethernet Cable" />
            <div class="img-cap">Figure. 4</div>
          </div>
        </li>
        <li>
          <p>One pack of <a href="https://www.amazon.com/Uxcell-a14050200ux0726-Female-Hexagon-Standoff/dp/B0166GCHD4"
            target="_blank"><span class="bold">M3 60mm</span></a> male-female brass spacers</p>
          <div id="img-outer-div"> <img src="./images/n2-03.png" class="img-cls" alt="M3 60mm Spacers" />
            <div class="img-cap">Figure. 5</div>
          </div>
        </li>
        <li>
          <p>One pack of <a href="https://www.amazon.com/gp/product/B00AO40MUA" target="_blank">
            <span class="bold">M3 12mm</span></a> male-female brass spacers</p>
          <div id="img-outer-div"> <img src="./images/n2-04.png" class="img-cls" alt="M3 12mm Spacers" />
            <div class="img-cap">Figure. 6</div>
          </div>
        </li>
        <li>
          <p>One pack of <a href="https://www.amazon.com/gp/product/B012TE12CY" target="_blank">
            <span class="bold">M3 6mm</span></a> phillips head steel screws</p>
          <div id="img-outer-div"> <img src="./images/n2-05.png" class="img-cls" alt="M3 6mm Screws" />
            <div class="img-cap">Figure. 7</div>
          </div>
        </li>
        <li>
          <p>One <a href="https://www.amazon.com/TP-Link-Ethernet-Splitter-Unmanaged-TL-SF1008D/dp/B0034CL3MA"
            target="_blank"><span class="bold">Multi-port Ethernet</span></a> switch (if your home network switch
            does not have enough of available ports)</p>
          <div id="img-outer-div"> <img src="./images/rpc-07.png" class="img-cls" alt="Ethernet Switch" />
            <div class="img-cap">Figure. 8</div>
          </div>
        <p>In my case, did not need one since have a 24-port <span class="bold">Ethernet Switch</span> with enough of
          free ports to use</p>
        </li>
        <li>
          <p>One <a href="https://www.amazon.com/Anker-Portable-Reader-RS-MMC-Micro/dp/B006T9B6R2" target="_blank">
            <span class="bold">Portable USB</span></a> card reader (if your desktop does not have a built-in media
            card reader)</p>
          <div id="img-outer-div"> <img src="./images/rpc-08.png" class="img-cls" alt="USB Card Reader" />
            <div class="img-cap">Figure. 9</div>
          </div>
        <p>In my case, did not need one since my desktop has a built-in media card reader</p>
        </li>
        <li>
          <p>One <a href="https://www.amazon.com/Belkin-BE112230-08-12-Outlet-Power-Protector/dp/B000J2EN4S" target="_blank">
            <span class="bold">Belkin BE112230-08</span></a> 12-outlet power strip</p>
          <div id="img-outer-div"> <img src="./images/xu4-07.png" class="img-cls" alt="Power Strip" />
            <div class="img-cap">Figure. 10</div>
          </div>
        </li>
        <li>
          <p>We need to firmly secure the <span class="bold">ODroid N2</span> onto a solid, flat platform, which can be
            stacked on top of one another. In my case, a trip to the local <a href="https://www.dollartree.com/"
            target="_blank"><span class="bold">Dollar Tree</span></a> yielded an interesting option -
            <a href="https://www.dollartree.com/rectangular-and-square-plastic-artsy-trays/280377" target="_blank">
            <span class="bold">12.5 cm x 12.5 cm Square</span></a> clear plastic artsy tray.</p>
          <div id="img-outer-div"> <img src="./images/n2-06.png" class="img-cls" alt="Plastic Artsy Trays" />
            <div class="img-cap">Figure. 11</div>
          </div>
          <p>For my cluster, purchased 5 of these.</p>
        </li>
      </ul>
    </div>
    <div id="section-div">
      <p>Part 2</p>
    </div>
    <div id="para-div">
      <p>Now comes the next stage - assemble the items to build the 5-node <span class="bold">ODroid N2</span> cluster.</p>
      <ul id="blue-sqr-ul">
        <li>
          <p><span class="bold">ODroid N2</span> is a bit unique in its design. Unlike <span class="bold">ODroid XU4</span>, 
            there are no holes on the <span class="bold">SBC</span> to easily stack them up on top of one another. This is
            due to the heatsink that occupies the entire bottom of the <span class="bold">SBC</span>. However, the heatsink
            has holes to screw the 12mm M3 brass spacers on to the 4 sides as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-07.png" class="img-cls" alt="Mounted 12mm Spacers" />
            <div class="img-cap">Figure. 12</div>
          </div>
          <p>Continue this process for the remaining units</p>
        </li>
        <li>
          <p>We need to drill 4 holes (red circles) to secure the <span class="bold">SBC</span>. Ensure the holes align with
            the four M3 12mm spacers we bolted onto the <span class="bold">SBC</span> in <span class="bold">Figure. 12</span>.
            In addition, we need another 4 holes (blue circles) on the corners of the plastic tray for stacking the trays on
            top of one another as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-08.png" class="img-cls" alt="Plastic Tray Holes" />
            <div class="img-cap">Figure. 13</div>
          </div>
          <p>Continue this process for the remaining units</p>
        </li>
        <li>
          <p>We need to secure the <span class="bold">ODroid N2</span> on top of the clear plastic tray using the M3 6mm
            screws through the 4 holes (red circles) from <span class="bold">Figure. 13</span> above as shown in the
            illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-09.png" class="img-cls" alt="Secure ODroid N2" />
            <div class="img-cap">Figure. 14</div>
          </div>
          <p>Continue this process for the remaining units</p>
        </li>
        <li>
          <p>Insert the 12mm M3 brass spacers through the 4 holes (blue circles) from <span class="bold">Figure. 13</span>
            above and screw them on top with the 60mm M3 brass spacers as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-10.png" class="img-cls" alt="Mounted Brass Columns" />
            <div class="img-cap">Figure. 15</div>
          </div>
          <p>This is for only one of the units that will be at base of the stack</p>
        </li>
        <li>
          <p>Stack the next plastic tray with the <span class="bold">SBC</span> from <span class="bold">Figure. 14</span>
            on top of the unit from <span class="bold">Figure. 15</span> and screw them on top with the 60mm M3 brass spacers
            as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-11.png" class="img-cls" alt="Stacked Trays" />
            <div class="img-cap">Figure. 16</div>
          </div>
          <p>Continue this process for the remaining units. For the topmost tray, secure with the 12mm M3 spacers</p>
        </li>
        <li>
          <p>The final finished cluster rack should look something like the illustration as shown below:</p>
          <div id="img-outer-div"> <img src="./images/n2-12.png" class="img-cls" alt="Finished Rack" />
            <div class="img-cap">Figure. 17</div>
          </div>
        </li>
        <li>
          <p>Next, download the latest stable release of <a href="https://wiki.odroid.com/odroid-n2/os_images/ubuntu/20190325"
            target="_blank"><span class="bold">Ubuntu MATE</span></a> Linux operating system (based on Ubuntu Bionic 18.04)
            as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-13.png" class="img-cls" alt="Download Ubuntu" />
            <div class="img-cap">Figure. 18</div>
          </div>
          <p>At the time of this writing, the version of Ubuntu MATE was <span class="hi-yellow">20190325</span>.</p>
        </li>
        <li>
          <p>Download the latest stable release of <a href="https://www.balena.io/etcher/" target="_blank">
            <span class="bold">Etcher</span></a>. This tool will be used to burn the Armbian operating system image
            onto each of the microSDXC cards</p>
        </li>
        <li>
          <p>Insert a microSDXC card into the sdcard reader, launch <span class="bold">Etcher</span>, select the Ubuntu MATE
            image. Then press the <span class="hi-blue">Flash!</span> button to burn the image onto the microSDXC card as
            shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/rpc-14.png" class="img-cls" alt="Flash OS Image" />
            <div class="img-cap">Figure. 19</div>
          </div>
        </li>
        <li>
          <p>Insert each of the flashed microSDXC card into the <span class="bold">ODroid N2</span> sd-card slot and ensure
            the toggle switch on the <span class="bold">ODroid N2</span> is positioned at <span class="hi-blue">MMC</span>
            instead of <span class="bold">SPI</span> as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-14.png" class="img-cls" alt="ODroid N2 with SDXC" />
            <div class="img-cap">Figure. 20</div>
          </div>
        </li>
      </ul>
    </div>
    <div id="section-div">
      <p>Part 3</p>
    </div>
    <div id="para-div">
      <p>Now comes the final stage - prepare each of the <span class="bold">ODroid N2</span> nodes for operation. Note, we
        want to connect, power-up, and setup each of the <span class="bold">ODroid N2</span> boards *<span class="underbold">
        ONE</span>* at a time.</p>
      <ul id="blue-sqr-ul">
        <li>
          <p>Attach the barrel end of the power adapter to the power slot on <span class="bold">ODroid N2</span> and plug the
            other end to the power strip. Similarly, attached one of the Ethernet cable to the RJ45 slot on <span class="bold">
            ODroid N2</span> and the other end to the Ethernet Switch as shown in the illustration below:</p>
          <div id="img-outer-div"> <img src="./images/n2-15.png" class="img-cls" alt="ODroid N2 Connected" />
            <div class="img-cap">Figure. 21</div>
          </div>
        </li>
        <li>
          <p>Connect a HDMI monitor to the <span class="bold">ODroid N2</span> using HDMI and power up the power strip. The
            <span class="bold">ODroid N2</span> should take few seconds to boot up and after a few seconds would completely
            power-off. This is the *<span class="underbold">NORMAL</span>* behavior. Turn off the power strip and turn it
            back on. In a few seconds, we will be presented with the Ubuntu MATE desktop. The default user-id is
            <span class="hi-green">odroid</span> and the default password is <span class="hi-yellow">odroid</span>.</p>
        </li>
        <li>
          <p>Change the default password to a more stronger and secure password by clicking on the Ubuntu menu on the top-left
            corner and choosing <span class="hi-yellow">Control Center</span> from the drop-down. On the <span class="bold">
            Control Center</span> screen, click on <span class="hi-green">Users and Groups</span> icon to change the default
            user password.</p>
        </li>
        <li>
          <p>Change the default date/time/timezone to the desired value by clicking on the Ubuntu menu on the top-left corner
            and choosing <span class="hi-yellow">Control Center</span> from the drop-down. On the <span class="bold">Control
            Center</span> screen, click on <span class="hi-green">Time and Date</span> icon to change the date/time/timezone.</p>
        </li>
        <li>
          <p>Open a terminal window by clicking on the Ubuntu menu top-left corner and the choosing
            <span class="hi-yellow">System Tools</span> -> <span class="hi-green">MATE Terminal</span> from the drop-down.
            In the terminal window, execute the following command:</p>
          <div id="cmd-div">
            <p>$ sudo pluma /etc/ssh/sshd_config</p>
          </div>
          <p>Change the value of <span class="hi-yellow">PermitRootLogin</span> from <span class="hi-green">yes</span> to
            <span class="hi-green">no</span>. Save the changes and exit the editor.</p>
        </li>
        <li>
          <p>We need to assign a unique host-name for each of the <span class="bold">ODroid N2</span> boards in the cluster.
            In the same terminal window, execute the following command:</p>
          <div id="cmd-div">
            <p>$ sudo pluma /etc/hostname</p>
          </div>
          <p>Change the host-name to, say, <span class="hi-yellow">my-n2-1</span>. Save the changes and exit the editor. For each
            of the remaining 4 cards we will assign the host-names from <span class="hi-green">my-n2-2</span> through
            <span class="hi-green">my-n2-5</span>.</p>
        </li>
        <li>
          <p>We need to assign a static ip address to each of the <span class="bold">ODroid N2</span> boards in the cluster. Click
            on the Ubuntu menu on the top-left corner and choose <span class="hi-yellow">Control Center</span> from the drop-down.
            On the <span class="bold">Control Center</span> screen, click on <span class="hi-green">Network Connections</span> icon.
            Choose <span class="bold">Wired connection 1</span> from the menu list and click on the edit icon at the bottom left
            corner (gear wheel icon). Select the tab labeled <span class="bold">IPv4 Settings</span>. Choose the value of
            <span class="hi-blue">Manual</span> for the <span class="bold">Method</span>. Set the ip address to, say,
            <span class="hi-blue">192.168.1.51</span>, network to <span class="hi-blue">255.255.255.0</span>, and the gateway to
            <span class="hi-blue">192.168.1.1</span>. Finally, set the value for <span class="bold">DNS Servers</span> to
            <span class="hi-vanila">8.8.8.8,8.8.4.4</span>. Save the changes by clicking on the <span class="bold">Save</span>
            button.</p>
          <p>For each of the remaining 4 cards we will assign the static ip addresses from <span class="hi-green">192.168.1.52</span>
            through <span class="hi-green">192.168.1.55</span>.</p>
        </li>
        <li>
          <p>Finally, we need to perform a system update to ensure we have the latest software updates. Click on the Ubuntu menu
            on the top-left corner and choose <span class="hi-yellow">Control Center</span> from the drop-down. On the
            <span class="bold">Control Center</span> screen, click on <span class="hi-green">Software Updater</span> icon to
            perform the system update.</p>
        </li>
        <li>
          <p>And the last step is to perform a reboot for some of the changes to take effect. In the terminal window, execute the
            following command:</p>
          <div id="cmd-div">
            <p>$ reboot</p>
          </div>
          <p>This will safely reboot the <span class="bold">ODroid N2</span> device</p>
        </li>
      </ul>
      <p>Perform the above steps for each of the remaining <span class="bold">ODroid N2</span> devices. Note that as we reboot
        each of the remaining <span class="bold">ODroid N2</span> cards, they each will get a different ip address assigned.</p>
      <p><span class="hi-green">Hurray !!!</span> At this point, we should have our <span class="bold">ODroid N2</span> cluster
        ready for action.</p>
    </div>
    <div id="section-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p><a href="https://wiki.odroid.com/odroid-n2/odroid-n2" target="_blank"><span class="bold">ODroid N2 Wiki</span></a></p>
      <p><a href="https://www.phoronix.com/scan.php?page=article&item=hardkernel-odroid-n2&num=1" target="_blank">
        <span class="bold">Phoronix ODROID N2 Benchmarks</span></a></p>
    </div>
    <br/>
    <hr class="line-hr" />
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
