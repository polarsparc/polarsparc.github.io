<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <meta name="author" content="Bhaskar.S">
    <meta name="description" content="Machine Learning - Data Preparation - Part 1">
    <meta name="subject" content="Machine Learning - Data Preparation - Part 1">
    <meta name="keywords" content="python, machine_learning, data_preparation, scikit-learn">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <title>Machine Learning - Data Preparation - Part 1</title>
    <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script>
      MathJax = {
        tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </head>
  <body>
    <br />
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Machine Learning - Data Preparation - Part 1</p>
    </div>
    <br />
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">05/15/2022</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" />
    <br />
    <div id="section-div">
      <p>Overview</p>
    </div>
    <div id="para-div">
      <p><span class="hi-yellow">Data Preparation</span> is a critical and time-consuming first phase in any Data Science project.
        This phase typically takes almost <span class="underbold">80%</span> of the total project time. In this article, we are
        using the term <span class="underbold">Data Preparation</span> to cover the following tasks:</p>
      <ol id="blue-ol">
        <li><p><span class="hi-yellow">Data Domain Knowledge</span> - This task involves acquiring the data domain knowledege and
          having a good understanding about the various features (data attributes)</p></li>
        <li><p><span class="hi-yellow">Exploratory Data Analysis</span> - <span class="hi-blue">EDA</span> for short, this task
          involves loading the raw data set for the data domain, performing initial analysis to gather insights from the loaded
          data set, understanding the various features and their types (discrete, continuous, categorical), identifying features
          with missing values, infering statistical information about the features (summary statistics, outliers, distibution),
          infering the relationships between the features, etc</p></li>
        <li><p><span class="hi-yellow">Feature Engineering</span> - This task involves using the information gathered from the EDA
          phase to encode the values of some of the categorical features to numerical, address missing values for some of the
          features, normalizing and scaling the feature values, adding additional features (derived features), etc</p></li>
      </ol>
    </div>
    <div id="para-div">
      <p>Note that the tasks <span class="underbold">2</span> and <span class="underbold">3</span> from the above cycle through
        iteratively until we arrive at a cleansed data set that can be used in the data science project.</p>
    </div>
    <div id="step-div">
      <p>Data Domain Knowledge</p>
    </div>
    <div id="para-div">
      <p>In this article, we will use the <span class="hi-yellow">City of Ames, Iowa Housing Prices</span> data set to perform the
        various tasks involved in the data preparation. This data set has a good number of features with a mix of both categorical
        and numerical data types as well as some features missing values.</p>
      <p>The following are the list of all the features (with their description) from the data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Features List" src="./images/dataprep-01.png" class="img-cls" />
      <div class="img-cap">Figure.1</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The features are pretty self-explanatory and easy to understand.</p>
    </div>
    <div id="step-div">
      <p>Exploratory Data Analysis</p>
    </div>
    <div id="para-div">
      <p>The first step is to import all the necessary Python modules such as, matplotlib, pandas, seaborn, and scikit-learn as
        shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to load the housing price dataset into a pandas dataframe as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>url = './data/ames.csv'
ames_df = pd.read_csv(url)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to display the first few samples from the housing price dataset as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>ahp_df.head(10)</pre>
      </div>
    </div>
    <div id="para-div">
      <p>The following illustration shows a section of columns of the first 10 rows of the housing price dataset:</p>
    </div>
    <div id="img-outer-div"> <img alt="First 10 Rows" src="./images/dataprep-02.png" class="img-cls" />
      <div class="img-cap">Figure.2</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to display the shape (rows and columns) of the housing price dataset as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>ames_df.shape</pre>
      </div>
    </div>
    <div id="para-div">
      <p>The following illustration shows the shape of the housing price dataset:</p>
    </div>
    <div id="img-outer-div"> <img alt="Shape" src="./images/dataprep-03.png" class="img-cls" />
      <div class="img-cap">Figure.3</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to display information about the housing price dataframe, such as index and column types, missing (null)
        values, memory usage, etc., as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>ames_df.info()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the information about the housing price dataframe:</p>
    </div>
    <div id="img-outer-div"> <img alt="Dataframe Information" src="./images/dataprep-04.png" class="img-cls" />
      <div class="img-cap">Figure.4</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that some features (annotated in red) have significantly large number of missing values.</p>
    </div>
    <div id="para-div">
      <p>The next step is to display the feature names from the housing price dataframe that have missing (nan) values as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>features_na = [feature for feature in ames_df.columns if ames_df[feature].isnull().sum() > 0]
features_na</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the list of all the feature names from the housing price dataframe with missing values:</p>
    </div>
    <div id="img-outer-div"> <img alt="Features NaN" src="./images/dataprep-05.png" class="img-cls" />
      <div class="img-cap">Figure.5</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to display the features and by what fraction they are missing values (in the descending order) from the
        housing price dataframe as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>ames_df[features_na].isnull().mean().sort_values()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the list of the feature names along with what fraction of values are missing (in the
        descending order) from the housing price dataframe:</p>
    </div>
    <div id="img-outer-div"> <img alt="Missing Fraction" src="./images/dataprep-06.png" class="img-cls" />
      <div class="img-cap">Figure.6</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that some features (annotated in red) have significantly large fraction of missing values.</p>
    </div>
    <div id="para-div">
      <p>The next step is to display the names of the categorical features from the housing price dataframe as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>ames_df.select_dtypes(include=['object']).columns.tolist()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the list of all the categorical features from the housing price dataframe:</p>
    </div>
    <div id="img-outer-div"> <img alt="Categorical Features" src="./images/dataprep-07.png" class="img-cls" />
      <div class="img-cap">Figure.7</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to split the housing price dataset into two parts - a training data set and a test data set. The training
        data set is used to train the model and the test data set is used to evaluate the model. In this use case, we split 75% of
        the samples into the training data set and remaining 25% into the test data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>X_train, X_test, y_train, y_test = train_test_split(ames_df, ames_df['SalePrice'], test_size=0.25, random_state=101)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The next step is to display the correlation between the numerical features and the target feature (SalePrice) for the
        housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>plt.figure(figsize=(24, 16))
sns.heatmap(X_train.corr(), annot=True, annot_kws={'size': 12}, cmap='coolwarm', fmt='0.2f', linewidth=0.1)
plt.show()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the correlation between the numerical features and the target (SalePrice) for the
        housing price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Feature Correlation" src="./images/dataprep-08.png" class="img-cls" />
      <div class="img-cap">Figure.8</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that some features (annotated in red) have no strong correlation (lesser than 50%) with the target (SalePrice).</p>
    </div>
    <div id="para-div">
      <p>The next step is to display the features by their correlation values to the target (SalePrice) (in the descending order)
        from the housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>X_train.corr()['SalePrice'].sort_values(ascending=False)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration displays the features by their correlation coefficient to the target (SalePrice) (in the descending
        order) from the housing price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Correlation Score" src="./images/dataprep-09.png" class="img-cls" />
      <div class="img-cap">Figure.9</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that some features (annotated in green) have a strong correlation (greater than 50%) with the target (SalePrice).</p>
    </div>
    <div id="para-div">
      <p>It is now time to gather insights about some of the features through visual plots using the housing price training data
        set. Let us examine the first few numerical features that are strongly correlated with the target (SalePrice).</p>
    </div>
    <div id="para-div">
      <p>The next step is to display a line plot between the numerical feature Overall.Qual (overall quality and finish) and the
        target SalePrice using the housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>plt.figure(figsize=(8, 7))
sns.lineplot(x='Overall.Qual', y='SalePrice', color='teal', data=X_train)
plt.show()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration shows the line plot between the numerical feature Overall.Qual and the target SalePrice using
        the housing price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Line Plot" src="./images/dataprep-10.png" class="img-cls" />
      <div class="img-cap">Figure.10</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that as the value of the feature Overall.Qual increases, so does the value of the SalePrice.</p>
    </div>
    <div id="para-div">
      <p>The next step is to display the scatter plot (with distribution) between the numerical feature Total.Bsmt.SF (total basement
        area in square feet) and the target SalePrice using the housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>sns.jointplot(x='Total.Bsmt.SF', y='SalePrice', kind='reg', height=8, joint_kws={'color':'tan', 'line_kws':{'color':'gray'}}, data=X_train)
plt.show()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration shows the scatter plot (with distribution) between the numerical feature Total.Bsmt.SF and the
        target SalePrice using the housing price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Scatter with Distribution" src="./images/dataprep-11.png" class="img-cls" />
      <div class="img-cap">Figure.11</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that as the value of the feature Total.Bsmt.SF increases, so does the value of the SalePrice. However, the increase
        in SalePrice seems to happen for Total.Bsmt.SF upto 3000 sqft.</p>
    </div>
    <div id="para-div">
      <p>The next step is to display a bar plot of the unique categorical values of the feature MS.Zoning (zoning classification)
        using the housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>plt.figure(figsize=(8, 7))
ax = sns.countplot(x='MS.Zoning', data=X_train)
ax.bar_label(ax.containers[0])
plt.show()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration shows the bar plot of the unique categorical values of the feature MS.Zoning using the housing
        price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Zoning Bar Plot" src="./images/dataprep-12.png" class="img-cls" />
      <div class="img-cap">Figure.12</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that as the value of RL (residential low density) zoning is the highest, which makes total sense.</p>
    </div>
    <div id="para-div">
      <p>The next step is to display the box plot between the categorical feature MS.Zoning and the target SalePrice using the
        housing price training data set as shown below:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-body-1">
<pre>sns.catplot(x='MS.Zoning', y='SalePrice', kind='box', height=8.0, data=X_train)
plt.show()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration shows the box plot between the categorical feature MS.Zoning and the target SalePrice using the
        housing price training data set:</p>
    </div>
    <div id="img-outer-div"> <img alt="Zoning Box Plot" src="./images/dataprep-13.png" class="img-cls" />
      <div class="img-cap">Figure.13</div>
    </div>
    <br/>
    <div id="section-div">
      <p>Hands-on Demo</p>
    </div>
    <div id="para-div">
      <p>The following is the link to the <span class="bold">Jupyter Notebooks</span> that provides an hands-on demo for this
        article:</p>
      <ul id="blue-sqr-ul">
        <li><p><a href="https://github.com/bhaskars-repo/MachineLearning/blob/main/P9-DataPreparation.ipynb" target="_blank">
          <span class="bold">Data Preparation - Part 1</span></a></p></li>
      </ul>
    </div>
    <br/>
    <hr class="line-hr" />
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
