<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <title>Introduction to Vagrant - Part 1</title>
    <link href="../css/polarsparc-v2.0.css" type="text/css" rel="stylesheet" />
  </head>
  <body> <br />
    <div id="title-div">
      <p>Introduction to Vagrant - Part 1</p>
    </div>
    <br />
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">01/14/2017</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" /> <br />
    <div id="section-div">
      <p>Overview</p>
    </div>
    <div id="para-div">
      <p>In a typical Enterprise, when a software developer is hired into a development
        team, there are two hurdles to overcome. One, the developer spends a significant
        amount of time setting up their development environment and two, they may have a
        development environment that may not be a replica of what is in production.
        Sounds familiar ???</p>
      <p>Wouldn't it be great if there was a way to automate the creation and setup of
        a sandboxed development environment that is a replica of what is in production
        with just one command ?</p>
      <p>Enter <span class="hi-yellow">Vagrant</span> !!!</p>
      <p><span class="bold">Vagrant</span> is an automation tool for creating and
        configuring a reproducible development sandbox using a virtual environment,
        such as, <span class="bold">Hyper-V</span>, <span class="bold">VirtualBox</span>,
        <span class="bold">VMWare</span>, or <span class="bold">Docker</span>.</p>
    </div>
    <div id="para-div">
      <p><span class="bold">Vagrant</span> is configured per virtual environment. Each
        virtual environment has an associated configuration file that is named
        <span class="hi-yellow">Vagrantfile</span>. In the <span class="bold">Vagrantfile</span>
         one specifies the various configuration aspects of the virtual environment,
         such as the amount of memory, no. of cpus, shared folders, etc.</p>
    </div>
    <div id="para-div">
      <p><span class="bold">Vagrant</span> leverages a base image for a desired virtual
        environment, such as a ubuntu xenial64 <span class="bold">VirtualBox</span> image,
        etc. This base image is called a <span class="hi-yellow">Box</span> in the
        <span class="bold">Vagrant</span> parlance.</p>
    </div>
    <div id="para-div">
      <p><span class="bold">Vagrant</span> ships with an out-of-the-box support for the
        popular virtual environments, namely, <span class="bold">Hyper-V</span>,
        <span class="bold">VirtualBox</span>, <span class="bold">VMWare</span>, or
        <span class="bold">Docker</span>, etc. In the <span class="bold">Vagrant</span>
        parlance, these virtual environments are called <span class="hi-yellow">Providers</span>.</p>
    </div>
    <div id="section-div">
      <p>Installation</p>
    </div>
    <div id="para-div">
      <p>The installation is on a <span class="bold">Ubuntu 16.04 LTS</span>
        based Linux desktop.</p>
    </div>
    <div id="para-div">
      <p>Make sure to install <span class="bold">VirtualBox</span> before installing
        <span class="bold">Vagrant</span>.</p>
    </div>
    <div id="cmd-div">
      <p>$ sudo apt-get update</p>
      <p>$ sudo apt-get install virtualbox</p>
      <p>$ sudo apt-get install vde2 virtualbox-guest-additions-iso</p>
      <p>$ sudo apt-get install vagrant</p>
    </div>
    <div id="para-div">
      <p>Once the commands complete, execute the following command to check everything
        is ok:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant version</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.1</h4>
      <pre>Installed Version: 1.8.1

Vagrant was unable to check for the latest version of Vagrant.
Please check manually at http://www.vagrantup.com</pre>
    </div>
    <div id="section-div">
      <p>Hands-on with Vagrant</p>
    </div>
    <div id="para-div">
      <p>Create a directory called <span class="bold">Vagrant</span> if not already
        present and change to that directory.</p>
    </div>
    <div id="para-div">
      <p>To create an initial <span class="bold">Vagrantfile</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant init</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.2</h4>
      <pre>A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.</pre>
    </div>
    <div id="para-div">
      <p>Search for a desired <span class="bold">Box</span> image for <span class="bold">VirtualBox</span>
        from <a target="_blank" href="https://atlas.hashicorp.com/boxes/search?provider=virtualbox">
        <span class="bold">Atlas by HashiCorp</span></a>. For our test, we will use the pre-built
        <span class="bold">Box</span> for Ubuntu 14.04, called <span class="hi-green">ubuntu/trusty64</span>.</p>
    </div>
    <div id="para-div">
      <p>Edit the generated <span class="bold">Vagrantfile</span> in the current
        directory to have the following contents:</p>
    </div>
    <div id="cmd-div">
      <p>Vagrant.configure(2) do |config|</p>
      <p>&nbsp;&nbsp;config.vm.box = "ubuntu/trusty64"</p>
      <p>&nbsp;&nbsp;config.vm.provider "virtualbox" do |vb|</p>
      <p>&nbsp;&nbsp;&nbsp;&nbsp;vb.memory = "1024"</p>
      <p>&nbsp;&nbsp;end</p>
      <p>end</p>
    </div>
    <div id="para-div">
      <p>This will configure a <span class="bold">VirtualBox</span> guest machine
        running <span class="bold">Ubuntu 14.04</span> in headless (no GUI) mode
        with 1024MB of memory.</p>
    </div>
    <div id="para-div">
      <p>To create and configure a virtual environment, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant up</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.3</h4>
      <pre>Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box 'ubuntu/trusty64' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Loading metadata for box 'ubuntu/trusty64'
    default: URL: https://atlas.hashicorp.com/ubuntu/trusty64
==> default: Adding box 'ubuntu/trusty64' (v20170110.0.0) for provider: virtualbox
    default: Downloading: https://atlas.hashicorp.com/ubuntu/boxes/trusty64/versions/20170110.0.0/providers/virtualbox.box
==> default: Successfully added box 'ubuntu/trusty64' (v20170110.0.0) for 'virtualbox'!
==> default: Importing base box 'ubuntu/trusty64'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'ubuntu/trusty64' is up to date...
==> default: Setting the name of the VM: Vagrant_default_1484445597151_33976
==> default: Clearing any previously set forwarded ports...
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Running 'pre-boot' VM customizations...
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: The guest additions on this VM do not match the installed version of
    default: VirtualBox! In most cases this is fine, but in rare cases it can
    default: prevent things such as shared folders from working properly. If you see
    default: shared folder errors, please make sure the guest additions within the
    default: virtual machine match the version of VirtualBox you have installed on
    default: your host and reload your VM.
    default:
    default: Guest Additions Version: 4.3.36
    default: VirtualBox Version: 5.0
==> default: Mounting shared folders...
    default: /vagrant => /home/vagrant/Vagrant</pre>
    </div>
    <div id="para-div">
      <p>To check the status, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant status</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.4</h4>
      <pre>Current machine states:

default                   running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.</pre>
    </div>
    <div id="para-div">
      <p>To login to the running <span class="bold">VirtualBox</span> guest machine,
        execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant ssh</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.5</h4>
      <pre>Welcome to Ubuntu 14.04.5 LTS (GNU/Linux 3.13.0-107-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

  System information as of Sun Jan 15 02:00:20 UTC 2017

  System load:  0.97              Processes:           83
  Usage of /:   3.6% of 39.34GB   Users logged in:     0
  Memory usage: 12%               IP address for eth0: 10.0.2.15
  Swap usage:   0%

  Graph this data and manage this system at:
    https://landscape.canonical.com/

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

0 packages can be updated.
0 updates are security updates.

New release '16.04.1 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


vagrant@vagrant-ubuntu-trusty-64:~$</pre>
    </div>
    <div id="para-div">
      <p>In the ssh session, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>vagrant@vagrant-ubuntu-trusty-64:~$ free -m</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.6</h4>
      <pre>             total       used       free     shared    buffers     cached
Mem:           993        358        635          0         12        230
-/+ buffers/cache:        115        878
Swap:            0          0          0</pre>
    </div>
    <div id="para-div">
      <p>To exit the ssh session, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>vagrant@vagrant-ubuntu-trusty-64:~$ exit</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.7</h4>
      <pre>logout
Connection to 127.0.0.1 closed.</pre>
    </div>
    <div id="para-div">
      <p><span class="bold">Hooray !!!</span> we have successfully created and
        launched our first <span class="bold">VirtualBox</span> guest machine
        using <span class="bold">Vagrant</span>.</p>
    </div>
    <div id="para-div">
      <p>To shutdown the running <span class="bold">VirtualBox</span> guest machine,
        execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant halt</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.8</h4>
      <pre>==> default: Attempting graceful shutdown of VM...</pre>
    </div>
    <div id="para-div">
      <p>To check the status, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant status</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.9</h4>
      <pre>Current machine states:

default                   poweroff (virtualbox)

The VM is powered off. To restart the VM, simply run `vagrant up`</pre>
    </div>
    <div id="para-div">
      <p>To destroy and clean up all the resources created as a result of running the
        <span class="bold">VirtualBox</span> guest machine, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant destroy</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.10</h4>
      <pre>    default: Are you sure you want to destroy the 'default' VM? [y/N] y
==> default: Destroying VM and associated drives...</pre>
    </div>
    <div id="para-div">
      <p>To list all the available <span class="bold">Box</span>es, execute
        the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant box list</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.11</h4>
      <pre>ubuntu/trusty64 (virtualbox, 20170110.0.0)</pre>
    </div>
    <div id="para-div">
      <p>To add a new <span class="bold">CentOS 7 Box</span> image called
        <span class="hi-green">centos/7</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant box add centos/7</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.12</h4>
      <pre>==> box: Loading metadata for box 'centos/7'
    box: URL: https://atlas.hashicorp.com/centos/7
This box can work with multiple providers! The providers that it
can work with are listed below. Please review the list and choose
the provider you will be working with.

1) libvirt
2) virtualbox
3) vmware_fusion
4) vmware_workstation

Enter your choice: 2
==> box: Adding box 'centos/7' (v1611.01) for provider: virtualbox
    box: Downloading: https://atlas.hashicorp.com/centos/boxes/7/versions/1611.01/providers/virtualbox.box
==> box: Successfully added box 'centos/7' (v1611.01) for 'virtualbox'!</pre>
    </div>
    <div id="para-div">
      <p>Again, list all the available <span class="bold">Box</span>es by executing
        the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant box list</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.13</h4>
      <pre>centos/7        (virtualbox, 1611.01)
ubuntu/trusty64 (virtualbox, 20170110.0.0)</pre>
    </div>
    <div id="para-div">
      <p>From the above, we see that the <span class="bold">CentOS 7 Box</span> image
        for <span class="bold">VirtualBox</span> has been added.</p>
    </div>
    <div id="para-div">
      <p>To remove the the <span class="bold">CentOS 7 Box</span> image, execute
        the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ vagrant box remove centos/7</p>
    </div>
    <div id="para-div">
      <p>The following would be a typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.14</h4>
      <pre>Removing box 'centos/7' (v1611.01) with provider 'virtualbox'...</pre>
    </div>
    <div id="para-div">
      <p>That is it for now ... More in the future part(s).</p>
    </div>
    <div id="section-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p><a href="https://www.vagrantup.com/docs/" target="_blank"><span class="bold">Official
            Vagrant Documentation</span></a></p>
    </div>
  </body>
</html>
