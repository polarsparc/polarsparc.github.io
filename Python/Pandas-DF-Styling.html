<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <meta name="author" content="Bhaskar.S">
    <meta name="description" content="Pandas DataFrame Styling">
    <meta name="subject" content="Pandas DataFrame Styling">
    <meta name="keywords" content="python, pandas">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <title>Pandas DataFrame Styling</title>
    <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br />
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Pandas DataFrame Styling</p>
    </div>
    <br />
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">06/21/2024</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" />
    <br/>
    <div id="section-div">
      <p>Overview</p>
    </div>
    <div id="para-div">
      <p>A <span class="bold">Pandas</span> <span class="hi-yellow">DataFrame</span> is a 2-dimensional, labeled table-like structure,
        with rows and columns (just like an <span class="bold">Excel</span> sheet), that is extensively used for slicing and dicing of
        data for analysis.</p>
      <p>To highlight the data insights, typically <span class="bold">Pandas</span> is used in conjunction with <span class="bold">
        Matplotlib</span> for data visualization. However, a <span class="bold">Pandas DataFrame</span> has built-in functionality
        for styling the <span class="bold">DataFrame</span> table in order to highlight the data insights.</p>
      <p>In this article, we will get our hands dirty in exploring how one can use the styling capability of the <span class="bold">
        Pandas</span> to make the <span class="bold">DataFrame</span> table more presentable.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Installation and Setup</p>
    </div>
    <div id="para-div">
      <p>Installation and setup will be on a Linux desktop running Ubuntu 22.04 LTS. Note that the stable Python version on Ubuntu
        22.04 is <span class="bold">3.10</span>.</p>
    </div>
    <div id="para-div">
      <p>For the demonstration, we will create a Python virtual environment using the <span class="hi-yellow">venv</span> module. In
        order to do that, we first need to install the package for <span class="bold">venv</span> by executing the following command
        in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ sudo apt install python3.10-venv</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The Python <span class="bold">venv</span> module allows one to create a lightweight virtual environments, each with its own
        directory structure, that are isolated from the system specific directory structure. To create a Python virtual environment,
        execute the following command(s) in the terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ cd $HOME/Downloads</p>
      <p>$ python3 -m venv venv</p>
    </div>
    <br/>
    <div id="para-div">
      <p>This will create a directory called <span class="bold">venv</span> under the current directory. On needs to activate the
        newly created virtual environment by executing the following command in the terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ source venv/bin/activate</p>
    </div>
    <br/>
    <div id="para-div">
      <p>On successful virtual environment activation, the prompt will be prefixed with <span class="hi-grey">(venv)</span>.</p>
    </div>
    <div id="para-div">
      <p>Finally, We will install the required Python modules by executing the following command(s) in the terminal window (with venv
        activated):</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ pip install jupyter matplotlib pandas</p>
    </div>
    <br/>
    <div id="para-div">
      <p>This completes the required installation and setup for the hands-on demonstration.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Hands-on Pandas DataFrame Styling</p>
    </div>
    <div id="para-div">
      <p>For the demonstration, we will create the following small dataset called <span class="hi-grey">insurance-small.csv</span>
        that will be located in the directory <span class="bold">$HOME/Downloads/data</span>:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">insurance-small.csv</div>
      <div class="src-body-1">
<pre>age,sex,bmi,children,smoker,region,charges
19,female,27.9,0,yes,southwest,16884.924
28,male,33,3,no,southeast,4449.462
33,male,22.705,0,no,northwest,21984.47061
46,female,33.44,1,no,southeast,8240.5896
37,female,27.74,3,no,northwest,7281.5056
60,female,25.84,0,no,northwest,28923.13692
25,male,26.22,0,no,northeast,2721.3208
62,female,26.29,0,yes,southeast,27808.7251
23,male,,0,no,southwest,1826.843
56,female,39.82,0,no,southeast,11090.7178
27,male,42.13,0,yes,southeast,39611.7577
52,female,30.78,1,no,northeast,10797.3362
23,male,23.845,0,no,northeast,2395.17155
30,male,35.3,0,yes,southwest,36837.467
60,female,,0,no,northeast,13228.84695
37,male,28.025,2,no,northwest,6203.90175
23,male,17.385,1,no,northwest,2775.19215
31,male,36.3,2,yes,southwest,38711
22,male,35.6,0,yes,southwest,35585.576
24,female,26.6,0,no,northeast,3046.062
31,female,36.63,2,no,southeast,4949.7587</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>We will be using <span class="bold">Jupyter Notebook</span> for all our hands-on demonstration.</p>
      <p>Open a terminal and ensure we are in the directory <span class="bold">$HOME/Downloads</span> and then execute the following
        command to launch the <span class="bold">Jupyter Notebook</span> environment:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>jupyter notebook</p>
    </div>
    <br/>
    <div id="para-div">
      <p>Note that all the following statements *<span class="underbold">MUST</span>* be executed in the next notebook code cell.</p>
    </div>
    <div id="para-div">
      <p>To import the <span class="hi-yellow">pandas</span> module, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>import pandas as pd</p>
    </div>
    <br/>
    <div id="para-div">
      <p>To initialize the two variables <span class="hi-vanila">n_rows</span> and <span class="hi-vanila">url</span>, execute the
        following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>n_rows = 10</p>
      <p>url = './data/insurance-small.csv'</p>
    </div>
    <br/>
    <div id="para-div">
      <p>To load our sample dataset into a <span class="bold">DataFrame</span> and display the first few rows, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>df = pd.read_csv(url)</p>
      <p>df.head(n_rows)</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Display Basic DataFrame" src="./images/pd-styling-01.png" class="img-cls" />
      <div class="img-cap">Figure.1</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To format the numbers for the columns <span class="hi-grey">bmi</span> and <span class="hi-grey">charges</span> to <span
        class="underbold">two</span> decimal places, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>df.head(n_rows).style.format({'bmi': '{:.2f}', 'charges': '{:.2f}'})</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Two Decimal Places" src="./images/pd-styling-02.png" class="img-cls" />
      <div class="img-cap">Figure.2</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To display borders around the table, change the background color, and the font of the data displayed, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray', 'font-size': '10pt'})</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Border, Background, Font" src="./images/pd-styling-03.png" class="img-cls" />
      <div class="img-cap">Figure.3</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To highlight the minimum, maximum, and null values in each of the columns, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray'}) \
  .highlight_min() \
  .highlight_max() \
  .highlight_null()</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Minimum, Maximum, and Null" src="./images/pd-styling-04.png" class="img-cls" />
      <div class="img-cap">Figure.4</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The minimum and maximum values share the same color and hence confusing the visualization !!!</p>
    </div>
    <div id="para-div">
      <p>To highlight the minimum, the maximum, and the null values with different background colors for each of the columns, execute
        the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray'}) \
  .highlight_min(color='lightgreen') \
  .highlight_max(color='salmon') \
  .highlight_null(color='lightgrey')</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Minimum, Maximum, and Null in Colors" src="./images/pd-styling-05.png" class="img-cls" />
      <div class="img-cap">Figure.5</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To highlight the minimum, the maximum, and the null values with different background and text colors for each of the columns,
        execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray'}) \
  .highlight_min(color='lightgreen') \
  .highlight_max(props='background-color: salmon; color: white') \
  .highlight_null(props='background-color: lightgrey; color: blue; font-weight: bold')</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Minimum, Maximum, and Null in Colors" src="./images/pd-styling-06.png" class="img-cls" />
      <div class="img-cap">Figure.6</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that by default the minimum, the maximum, and the null values are determined for <span class="underbold">ALL</span>
        the columns !!!</p>
    </div>
    <div id="para-div">
      <p>To highlight the minimum, the maximum, and the null values with different background and text colors for specific columns,
        execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray', 'font-weight': 'bold', 'font-style': 'italic'}) \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white') \
  .highlight_null(subset=['bmi', 'charges'], props='background-color: lightgrey; color: blue; font-weight: bold')</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Minimum, Maximum, and Null for Specific" src="./images/pd-styling-07.png" class="img-cls" />
      <div class="img-cap">Figure.7</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To display the range of number in different text color gradient for the column <span class="hi-grey">age</span>, execute the
        following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray'}) \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white') \
  .highlight_null(subset=['bmi', 'charges'], props='background-color: lightgrey; color: blue; font-weight: bold') \
  .text_gradient(subset=['age'], cmap='Dark2', vmin=1, vmax=100)</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Age Text Gradient" src="./images/pd-styling-08.png" class="img-cls" />
      <div class="img-cap">Figure.8</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To display row and column labels with a selected background color and text color, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray'}) \
  .set_table_styles([{'selector': 'th', 'props': [('background-color', 'gray'), ('color', 'white')]}]) \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white')</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Row and Column Style" src="./images/pd-styling-09.png" class="img-cls" />
      <div class="img-cap">Figure.9</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that the columns names don't seem to have any kind of separation !!!</p>
    </div>
    <div id="para-div">
      <p>To hide the row labels and just display column labels with separation, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray', 'font-size': '10pt'}) \
  .set_table_styles([{'selector': 'th', 'props': [('background-color', 'gray'), ('color', 'white'), ('border', '2.0px solid white')]}]) \
  .hide() \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white')</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Columns with Separation" src="./images/pd-styling-10.png" class="img-cls" />
      <div class="img-cap">Figure.10</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To highlight the cells for the specific column <span class="hi-grey">smoker</span> that has the value of <span class="hi-red">
        yes</span>, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>def is_smoker(col):
  return 'background-color: yellow; color: red; font-weight: bold' if col == 'yes' else 'color: green; font-weight: bold'
    
df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray', 'font-size': '10pt'}) \
  .set_table_styles([{'selector': 'th', 'props': [('background-color', 'gray'), ('color', 'white'), ('border', '2.0px solid white')]}]) \
  .hide() \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white') \
  .map(is_smoker, subset=['smoker'])</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Smoker Column with Yes" src="./images/pd-styling-11.png" class="img-cls" />
      <div class="img-cap">Figure.11</div>
    </div>
    <br/>
    <div id="para-div">
      <p>To highlight the entire row for the specific column <span class="hi-grey">smoker</span> with the value <span class="hi-red">
        yes</span>, execute the following:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p><pre>def is_smoker(row):
  n_cols = len(row)
  return n_cols * ['background-color: yellow; color: red; font-style: italic'] if row['smoker'] == 'yes' else n_cols * ['']
    
df.head(n_rows).style \
  .format({'bmi': '{:.2f}', 'charges': '{:.2f}'}) \
  .set_properties(**{'background-color': 'azure', 'border': '2.0px solid gray', 'color': 'gray', 'font-size': '10pt'}) \
  .set_table_styles([{'selector': 'th', 'props': [('background-color', 'gray'), ('color', 'white'), ('border', '2.0px solid white')]}]) \
  .hide() \
  .highlight_min(subset=['bmi', 'charges'], color='lightgreen') \
  .highlight_max(subset=['bmi', 'charges'], props='background-color: salmon; color: white') \
  .apply(is_smoker, axis=1)</pre></p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following illustration would be the typical output:</p>
    </div>
    <br/>
    <div id="img-outer-div">
      <img alt="Entire Row for Smoker" src="./images/pd-styling-12.png" class="img-cls" />
      <div class="img-cap">Figure.12</div>
    </div>
    <br/>
    <div id="para-div">
      <p>This concludes the hands-on demonstration on styling the <span class="bold">Pandas DataFrame</span> and note that we have
        barely scratched the surface !!!</p>
    </div>
    <br/>
    <div id="section-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p><a href="https://pandas.pydata.org/docs/reference/style.html" target="_blank"><span class="bold">Pandas Dataframe Style Documentation</span></a></p>
    </div>
    <br/>
    <hr class="line-hr"/>
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
