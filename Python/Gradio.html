<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <meta name="author" content="Bhaskar.S">
    <meta name="description" content="Quick Primer on Gradio">
    <meta name="subject" content="Quick Primer on Gradio">
    <meta name="keywords" content="ai, ml, gradio, llm">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <title>Quick Primer on Gradio</title>
    <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br/>
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Quick Primer on Gradio</p>
    </div>
    <br/>
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">04/05/2025</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr"/>
    <br/>
    <div id="section-div">
      <p>Overview</p>
    </div>
    <div id="para-div">
      <p>AI/ML apps are built to solve specific business or customer problems and are often deployed as a web application. One could
        levarge the traditional web frameworks such as <span class="bold">Flask</span> or <span class="bold">Django</span> to build
        these AI/ML apps. However, these frameworks require a decent amount of web experience and knowledge. What if there existed
        an easier way to build and deploy AI/ML apps ?</p>
      <p>Well, this is where the open-source framework <span class="hi-yellow">Gradio</span> comes into the picture !!!</p>
      <p><span class="bold">Gradio</span> is an open-source Python framework that allows one to quickly build and deploy any AI/ML
        web application in a short order with zero web experience. In addition, <span class="bold">Gradio</span> applications can
        be deployed in <span class="bold">HuggingFace Spaces</span> for sharing with the world.</p>
      <p>In this primer, we will demonstrate how one can effectively setup and use the <span class="bold">Gradio</span> framework.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Installation and Setup</p>
    </div>
    <div id="para-div">
      <p>The installation and setup will be on a <span class="bold">Ubuntu 24.04 LTS</span> based Linux desktop. Ensure that <span
        class="bold">Ollama</span> is installed and setup on the desktop (see <a href="http://polarsparc.github.io/GenAI/Ollama.html"
        target="_blank"><span class="bold">instructions</span></a>).</p>
      <p>In addition, ensure that the <span class="bold">Python 3.x</span> programming language is installed and setup on the desktop.</p>
    </div>
    <div id="para-div">
      <p>To install the necessary <span class="bold">Python</span> packages, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ pip install gradio ollama pillow</p>
    </div>
    <br/>
    <div id="para-div">
      <p>This completes all the necessary installation and setup for the <span class="bold">Gradio</span> hands-on demonstration.</p>
    </div>
    <br/>
    <div id="section-div">
      <p>Hands-on with Gradio</p>
    </div>
    <br/>
    <div id="para-div">
      <p>In the following paragraphs, we will get our hands dirty with the <span class="bold">Gradio</span> framework. So, without
        further ado, let us get started !!!</p>
    </div>
    <div id="para-div">
      <p>The following is our first <span class="bold">Gradio</span> Python code:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-1.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   23 Mar 2025
#

import gradio as gr

def greet(name: str) -> str:
  return f'Hello, {name}!'

if __name__ == '__main__':
  # Automatically creates Submit and Clear buttons by default
  app = gr.Interface(
    fn=greet,
    inputs=['text'],
    outputs=['text'],
    flagging_mode='never',
    title='Hello Greeter!',
  )

  # Host 127.0.0.1, Port 7860
  app.launch()</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-1.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following would be the typical output:</p>
    </div>
    <br/>
    <div id="out-div">
      <h4>Output.1</h4>
      <pre>* Running on local URL:  http://127.0.0.1:7860

To create a public link, set `share=True` in `launch()`.</pre>
    </div>
    <br/>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://127.0.0.1:7860</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-01.png" alt="Sample 1" />
      <div class="img-cap">Figure.1</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Enter a name and click on the <span class="bold">Submit</span> button and the following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-02.png" alt="Sample 1 Name Click" />
      <div class="img-cap">Figure.2</div>
    </div>
    <br/>
    <div id="para-div">
      <p><span class="bold">WALLA</span> !!! With just a few lines of Python code, we were able to create and launch a slick web
        application !!!</p>
    </div>
    <div id="para-div">
      <p>The code from <span class="bold">sample-1.py</span> above needs some explanation:</p>
      <p>The class <span class="hi-green">Interface</span> has the following three core parameters:</p>
      <ul id="blue-sqr-ul">
        <li><span class="hi-vanila">inputs</span>: a list of UI components that accept user inputs</li>
        <li><span class="hi-vanila">outputs</span>: a list of UI components that used for outputs</li>
        <li><span class="hi-vanila">fn</span>: a reference to a Python function that accepts the values from the inputs (must match
          the number of UI inputs), performs the necessary business computation and returns a list of values for the outputs (must
          match the number of UI outputs)</li>
      </ul>
      <p>The string <span class="hi-green">'text'</span> in either the inputs or outputs list refers to the UI component <span class
        ="hi-blue">Textbox</span>.</p>
      <p>The function call <span class="hi-blue">launch()</span> with no parameters, launches a simple webserver on the local host
        (<span class="bold">127.0.0.1</span>) on the port <span class="bold">7860</span>.</p>
      <p>The Python function <span class="hi-blue">greet(name: str) -&gt; str</span> takes as input a set of arguments that matches
        the number of UI inputs and returns a set of values (as a tuple) that matches the number of UI outputs. In this case, the
        input is from the UI component <span class="bold">Textbox</span> and the output is to the UI component <span class="bold">
        Textbox</span>.</p>
    </div>
    <div id="para-div">
      <p>Next, the following is our second <span class="bold">Gradio</span> Python code that explicitly uses the <span class="bold">
        Gradio</span> UI components:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-2.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   23 Mar 2025
#

import gradio as gr

def greet(name: str) -> str:
  return f'Hello, {name}!'

if __name__ == '__main__':
  # Automatically creates Submit and Clear buttons by default
  app = gr.Interface(
    fn=greet,
    inputs=[gr.Textbox(label='Name', placeholder='enter name here', lines=1)],
    outputs=[gr.Textbox(label='Message', lines=1)],
    flagging_mode='never',
    title='Hello Greeter!',
  )

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-2.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following would be the typical output:</p>
    </div>
    <br/>
    <div id="out-div">
      <h4>Output.2</h4>
      <pre>* Running on local URL:  http://192.168.1.25:8080

To create a public link, set `share=True` in `launch()`.</pre>
    </div>
    <br/>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-03.png" alt="Sample 2" />
      <div class="img-cap">Figure.3</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Enter a name and click on the <span class="bold">Submit</span> button and the following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-04.png" alt="Sample 2 Name Click" />
      <div class="img-cap">Figure.4</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-2.py</span> above needs some explanation:</p>
      <p>The class <span class="hi-green">Textbox</span> uses the following parameters to customize the UI component:</p>
      <ul id="blue-sqr-ul">
        <li><span class="hi-vanila">label</span>: a text label for the component</li>
        <li><span class="hi-vanila">placeholder</span>: a hint text for the component</li>
        <li><span class="hi-vanila">lines</span>: the minimum number of rows for the component</li>
      </ul>
      <p>The function call <span class="hi-blue">launch(server_name, server_port)</span> uses two parameters to specific the network
        host and the network port on which to start the webserver.</p>
    </div>
    <div id="para-div">
      <p>Moving along, the following is our third <span class="bold">Gradio</span> Python code that explicitly lays out the various
        <span class="bold">Gradio</span> UI components:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-3.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   23 Mar 2025
#

import gradio as gr

def greet(who: str) -> str:
  return f'Hello, {who}!'

if __name__ == '__main__':
  # Explicitly create UI components including buttons
  with gr.Blocks() as app:
    name = gr.Textbox(label='Name', placeholder='enter name here')
    output = gr.Textbox(label='Message')
    greet_btn = gr.Button('Greet')
    reset_btn = gr.Button('Reset')
    greet_btn.click(fn=greet, inputs=[name], outputs=[output])
    reset_btn.click(fn=lambda: [None, None], outputs=[name, output])

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-3.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-05.png" alt="Sample 3" />
      <div class="img-cap">Figure.5</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Enter a name and click on the <span class="bold">Greet</span> button and the following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-06.png" alt="Sample 3 Name Click" />
      <div class="img-cap">Figure.6</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-3.py</span> above needs some explanation:</p>
      <p>The context class <span class="hi-green">Blocks</span> allows for a fine-grained control of what UI components to use, how
        they are configured for event handling, and how they are laid out on the screen.</p>
      <p>The class <span class="hi-green">Button</span> uses the <span class="hi-vanila">label</span> parameter to customize the
        text label on the button component.</p>
      <p>The function call <span class="hi-blue">click()</span> on the <span class="bold">Button</span> uses the following three
        parameters:</p>
      <ul id="blue-sqr-ul">
        <li><span class="hi-vanila">inputs</span>: a list of UI components that accept user inputs</li>
        <li><span class="hi-vanila">outputs</span>: a list of UI components that used for outputs</li>
        <li><span class="hi-vanila">fn</span>: a reference to a Python function that is triggered when the button is clicked and
          accepts the values from the inputs (must match the number of UI inputs), performs the necessary business computation and
          returns a list of values for the outputs (must match the number of UI outputs)</li>
      </ul>
      <p>Notice that the function parameter <span class="bold">fn</span> on the <span class="bold">Reset</span> button takes in a
        lambda function that returns a list of <span class="bold">None</span> values, which effectively clears the input and output
        values.</p>
    </div>
    <div id="para-div">
      <p>Moving along, the following is our fourth <span class="bold">Gradio</span> Python code that adds additional <span class=
        "bold">Gradio</span> UI components to the interface:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-4.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   29 Mar 2025
#

import gradio as gr

def greet(title: str, name: str, num: int):
  return f'Hello, {title} {name}!', num

if __name__ == '__main__':
  # Automatically creates Submit and Clear buttons by default
  app = gr.Interface(
      fn=greet,
      inputs=[gr.Radio(['Mr', 'Ms']), 'text', 'slider'],
      outputs=['text', 'number'],
      flagging_mode='never',
      title='Hello Greeter (with Title, Number) !',
  )

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-4.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-07.png" alt="Sample 4" />
      <div class="img-cap">Figure.7</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Select a title, enter a name, select a number on the slider, and click on the <span class="bold">Submit</span> button and
        the following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-08.png" alt="Sample 4 Name & Slider" />
      <div class="img-cap">Figure.8</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-4.py</span> above needs some explanation:</p>
      <p>The class <span class="hi-green">Radio</span> defines a radio button component and accepts a list of options.</p>
      <p>The string <span class="hi-green">'slider'</span> in the inputs list refers to the UI component <span class="hi-blue">Slider
        </span> with a default minimum value of 0 and a default maximum value of 100.</p>
    </div>
    <div id="para-div">
      <p>Shifting gears, the following is our fifth <span class="bold">Gradio</span> Python code that demonstrates the use of <span
        class="bold">Gradio</span> image component:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-5.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   29 Mar 2025
#

import gradio as gr
import numpy as np

# Apply Sepia filter to the input image (passed in as a numpy array)
def sepia_filter(inp_img):
  filter = np.array([
      [0.393, 0.769, 0.189],
      [0.349, 0.686, 0.168],
      [0.272, 0.534, 0.131]
  ])
  out_img = inp_img.dot(filter.T)
  out_img /= out_img.max()
  return out_img

if __name__ == '__main__':
  # Automatically creates Submit and Clear buttons by default
  app = gr.Interface(
    fn=sepia_filter,
    # Default image type: 'numpy'
    inputs=gr.Image(height=300, width=300),
    outputs='image',
    flagging_mode='never',
    title='Sepia Image Processing !',
  )

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-5.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-09.png" alt="Sample 5" />
      <div class="img-cap">Figure.9</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Select an image from the desktop and click on the <span class="bold">Submit</span> button and the following illustration
        depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-10.png" alt="Sample 5 Image" />
      <div class="img-cap">Figure.10</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-5.py</span> above needs some explanation:</p>
      <p>The class <span class="hi-green">Image</span> defines the image component that allows one to either upload an image as an
        input or display as an output. By default, the loaded image is passed to the Python function as a numpy array. In this case
        the Python function converts the provided image as a Sepia image by applying a filter.</p>
    </div>
    <div id="para-div">
      <p>Next, the following is our sixth <span class="bold">Gradio</span> Python code that tweaks the <span class="bold">Gradio</span>
        image component to pass the input image in the pillow format:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-6.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   29 Mar 2025
#

from PIL import ImageOps
import gradio as gr

# Apply Grayscale filter to the input image (as a pillow image)
def grayscale_filter(inp_img):
  return ImageOps.grayscale(inp_img)

if __name__ == '__main__':
  # Creates a Submit and Clear buttons by default
  app = gr.Interface(
    fn=grayscale_filter,
    inputs=gr.Image(height=300, width=300, type='pil'),
    outputs='image',
    flagging_mode='never',
    title='Grayscale Image Processing !',
  )

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-6.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-11.png" alt="Sample 6" />
      <div class="img-cap">Figure.11</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Select an image from the desktop and click on the <span class="bold">Submit</span> button and the following illustration
        depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-12.png" alt="Sample 6 Image" />
      <div class="img-cap">Figure.12</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that the code from <span class="bold">sample-6.py</span> customizes the image class by specifying the type as <span
        class="hi-grey">'pil'</span>. This passes the input image in the pillow format to the Python function, which converts the
        provided image to a grayscale image.</p>
    </div>
    <div id="para-div">
      <p>Moving on, the following is our seventh <span class="bold">Gradio</span> Python code that demonstrates how one can manage
        the session state in a <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-7.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   29 Mar 2025
#

import gradio as gr

def message_with_history(message: str, history: [str]):
  json = {
      'message': message,
      'history': history[::-1]
  }
  history.append(message)
  return json, history

if __name__ == '__main__':
  # Creates a Submit and Clear buttons by default
  app = gr.Interface(
    fn=message_with_history,
    inputs=['text', gr.State([])],
    outputs=['json', gr.State()],
    flagging_mode='never',
    title='Messaging with History !',
  )

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-7.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-13.png" alt="Sample 7" />
      <div class="img-cap">Figure.13</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Enter a message and click on the <span class="bold">Submit</span> button and the following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-14.png" alt="Sample 7 Message Click" />
      <div class="img-cap">Figure.14</div>
    </div>
    <br/>
    <div id="para-div">
      <p>One more time, enter a new message and click on the <span class="bold">Submit</span> button and the following illustration
        depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-15.png" alt="Sample 7 Message History" />
      <div class="img-cap">Figure.15</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-7.py</span> above needs some explanation:</p>
      <p>An instance of the class <span class="hi-green">State</span> maintains the session state across multiple submits within a
        web page in a <span class="bold">Gradio</span> web application. Also, the session state is <span class="underbold">NOT</span>
        shared across multiple browser instances.</p>
      <p>Note that an instance of <span class="bold">State</span> class <span class="underbold">MUST</span> be added to both the
        inputs and outputs list in the <span class="bold">Interface</span> class. Accordingly, the Python event listener function
        must be tweak to pass in the session state as a history parameter and returned after the session state is updated.</p>
    </div>
    <div id="para-div">
      <p>Next, the following is our eighth <span class="bold">Gradio</span> Python code that customizes the layout of the web page
        using rows and columns containing the various <span class="bold">Gradio</span> UI components:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-8.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   30 Mar 2025
#

import gradio as gr

# Interest time period : 1 year
def interest_calculator(option: str, principal: float, rate:float) -> float:
  time = 1
  if option == 'simple':
    return principal * rate / 100.00 * time
  return principal * (1 + rate / 100.0) ** time

if __name__ == '__main__':
  with gr.Blocks(theme=gr.themes.Soft()) as app:
    with gr.Row():
      with gr.Column():
        opt = gr.Radio(choices=['simple', 'compound'], value='simple', label='Type')
        pri = gr.Number(label='Principal')
        rt = gr.Number(label='Rate')
        calc_btn = gr.Button('Calculate')
      with gr.Column():
        res = gr.Number(label='Interest')
    calc_btn.click(fn=interest_calculator, inputs=[opt, pri, rt], outputs=[res])

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>To execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-8.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-16.png" alt="Sample 8" />
      <div class="img-cap">Figure.16</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Select the interest type, enter the principal and interest rate values, and click on the <span class="bold">Calculate</span>
        button. The following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-17.png" alt="Sample 8 Interest Click" />
      <div class="img-cap">Figure.17</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-8.py</span> above needs some explanation:</p>
      <p>The theme parameter specified in the context class <span class="hi-green">Block</span> customizes the look and feel of
        the web page.</p>
      <p>The UI components within the context class <span class="hi-green">Row</span> are laid out horizontally in a row.</p>
      <p>The UI components within the context class <span class="hi-green">Column</span> are laid out vertically in a column.</p>
    </div>
    <div id="para-div">
      <p>Finally, the following is our ninth <span class="bold">Gradio</span> Python code that demonstrates how one can develop an
        LLM chatbot application using the <span class="bold">Gradio</span> UI components and the <span class="bold">Ollama</span>
        chat client:</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">sample-9.py</div>
      <div class="gen-src-body">
<pre>#
# @Author: Bhaskar S
# @Blog:   https://www.polarsparc.com
# @Date:   30 Mar 2025
#

from ollama import Client
import gradio as gr

ollama_base_url = 'http://192.168.1.25:11434'

client = Client(host=ollama_base_url)

def ollama_response(option: str, temperature: float, prompt: str) -> str:
  model = 'gemma3:4b'
  if option == 'Granite-3.1':
    model = 'granite3.1-moe:1b'
  elif option == 'Phi-4':
    model = 'phi4-mini:latest'
  response = client.chat(model=model, messages=[{'role': 'user', 'content': prompt}], options={'temperature': temperature})
  return response['message']['content']

def chat_fn(option: str, temperature: float, prompt: str, history: [str]):
  response = ollama_response(option, temperature, prompt)
  history.append({'role': 'user', 'content': prompt})
  history.append({'role': 'assistant', 'content': response})
  return '', history

if __name__ == '__main__':
  with gr.Blocks(theme=gr.themes.Base(), title='Ollama Chatbot') as app:
    with gr.Column():
      cbt = gr.Chatbot(type='messages')
      mod = gr.Radio(choices=['Gemma-3', 'Granite-3.1', 'Phi-4'], value='Gemma-3', label='Model')
      tmp = gr.Slider(label='Temperature', minimum=0.0, maximum=1.0, step=0.1, value=0.0)
      msg = gr.Text(label='Prompt', placeholder='Enter prompt here ...')
      sub_btn = gr.Button('Submit')
      clr_btn = gr.ClearButton([msg])
    sub_btn.click(fn=chat_fn, inputs=[mod, tmp, msg, cbt], outputs=[msg, cbt])

  # Host 192.168.1.25, Port 8080
  app.launch(server_name='192.168.1.25', server_port=8080)</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>As a prerequisite, start the <span class="bold">Ollama</span> platform by executing the following command in the terminal
        window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ docker run --rm --name ollama --gpus=all --network=host -p 192.168.1.25:11434:11434 -v $HOME/.ollama:/root/.ollama ollama/ollama:0.6.5</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The following should be the typical trimmed output:</p>
    </div>
    <br/>
    <div id="out-div">
      <h4>Output.3</h4>
      <pre>-----[TRIM]-----
2025/04/05 19:57:57 routes.go:1230: INFO server config env="map[CUDA_VISIBLE_DEVICES: GPU_DEVICE_ORDINAL: HIP_VISIBLE_DEVICES: HSA_OVERRIDE_GFX_VERSION: HTTPS_PROXY: HTTP_PROXY: NO_PROXY: OLLAMA_CONTEXT_LENGTH:2048 OLLAMA_DEBUG:false OLLAMA_FLASH_ATTENTION:false OLLAMA_GPU_OVERHEAD:0 OLLAMA_HOST:http://0.0.0.0:11434 OLLAMA_INTEL_GPU:false OLLAMA_KEEP_ALIVE:5m0s OLLAMA_KV_CACHE_TYPE: OLLAMA_LLM_LIBRARY: OLLAMA_LOAD_TIMEOUT:5m0s OLLAMA_MAX_LOADED_MODELS:0 OLLAMA_MAX_QUEUE:512 OLLAMA_MODELS:/root/.ollama/models OLLAMA_MULTIUSER_CACHE:false OLLAMA_NEW_ENGINE:false OLLAMA_NOHISTORY:false OLLAMA_NOPRUNE:false OLLAMA_NUM_PARALLEL:0 OLLAMA_ORIGINS:[http://localhost https://localhost http://localhost:* https://localhost:* http://127.0.0.1 https://127.0.0.1 http://127.0.0.1:* https://127.0.0.1:* http://0.0.0.0 https://0.0.0.0 http://0.0.0.0:* https://0.0.0.0:* app://* file://* tauri://* vscode-webview://* vscode-file://*] OLLAMA_SCHED_SPREAD:false ROCR_VISIBLE_DEVICES: http_proxy: https_proxy: no_proxy:]"
time=2025-04-05T19:57:57.760Z level=INFO source=images.go:432 msg="total blobs: 19"
time=2025-04-05T19:57:57.760Z level=INFO source=images.go:439 msg="total unused blobs removed: 0"
time=2025-04-05T19:57:57.760Z level=INFO source=routes.go:1297 msg="Listening on [::]:11434 (version 0.6.2)"
time=2025-04-05T19:57:57.761Z level=INFO source=gpu.go:217 msg="looking for compatible GPUs"
time=2025-04-05T19:57:57.872Z level=INFO source=types.go:130 msg="inference compute" id=GPU-a66f63e7-5788-2e6e-1ebf-83dfcc1b6b4e library=cuda variant=v12 compute=8.9 driver=12.4 name="NVIDIA GeForce RTX 4060 Ti" total="15.7 GiB" available="14.8 GiB"</pre>
    </div>
    <br/>
    <div id="para-div">
      <p>Next, to execute the above Python code, execute the following command in a terminal window:</p>
    </div>
    <br/>
    <div id="cmd-div">
      <p>$ python sample-9.py</p>
    </div>
    <br/>
    <div id="para-div">
      <p>The output would be similar to that of <span class="bold">Output.2</span> from above.</p>
    </div>
    <div id="para-div">
      <p>Open a browser and enter the URL link <span class="bold">http://192.168.1.25:8080</span>. The following illustration depicts
        the launched <span class="bold">Gradio</span> web application:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-18.png" alt="Sample 9" />
      <div class="img-cap">Figure.18</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Type in a prompt and click on the <span class="bold">Submit</span> button. The following illustration depicts the outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-19.png" alt="Sample 9 Prompt Click" />
      <div class="img-cap">Figure.19</div>
    </div>
    <br/>
    <div id="para-div">
      <p>Key in a related prompt and click on the <span class="bold">Submit</span> button. The following illustration depicts the
        outcome:</p>
    </div>
    <br/>
    <div id="img-outer-div"> <img class="img-cls" src="./images/gradio-20.png" alt="Sample 9 Context Click" />
      <div class="img-cap">Figure.20</div>
    </div>
    <br/>
    <div id="para-div">
      <p>The code from <span class="bold">sample-9.py</span> above needs some explanation:</p>
      <p>The class <span class="hi-green">Chatbot</span> creates a chatbot UI component that displays the user prompts and the LLM
        responses. Note that it is initialized with a type parameter of <span class="hi-vanila">'messages'</span>.</p>
      <p>The data sent to and from the chatbot <span class="underbold">MUST</span> be a list of dictionaries with role and content
        keys. This format is compliant with the format expected by most LLM APIs including the <span class="bold">Ollama</span>.</p>
    </div>
    <div id="para-div">
      <p>With this, we conclude the various demonstrations on using the <span class="bold">Gradio</span> framework for building and
        deploying AI/ML web applications !!!</p>
    </div>
    <br/>
    <div id="section-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p><a href="https://www.gradio.app/guides/quickstart" target="_blank"><span class="bold">Gradio Quick Start</span></a></p>
      <p><a href="https://www.gradio.app/docs" target="_blank"><span class="bold">Gradio Documentation</span></a></p>
    </div>
    <br/>
    <hr class="line-hr" />
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
