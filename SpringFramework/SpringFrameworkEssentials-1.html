<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
      <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
      <meta name="author" content="Bhaskar.S">
      <meta name="description" content="Spring Framework Core Essentials - Part 1">
      <meta name="subject" content="Spring Framework Core Essentials - Part 1">
      <meta name="keywords" content="java, spring">
      <meta name="robots" content="index,follow">
      <meta name="googlebot" content="index,follow">
      <title>Spring Framework Core Essentials - Part 1</title>
      <link href="../css/polarsparc-v2.0.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br/>
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Spring Framework Core Essentials - Part 1</p>
    </div>
    <br/>
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">07/06/2019</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" />
    <br/>
    <div id="step-div">
      <p>Overview</p>
    </div>
    <div id="para-div">
      <p><span class="hi-yellow">Spring Framework</span> is a lightweight, modular, open-source <span class="bold">Java</span>
        application platform that provides an <span class="hi-yellow">Inversion of Control</span> (<span class="bold">IoC</span>)
        or <span class="hi-yellow">Dependency Injection</span> (<span class="bold">DI</span>) container. In a IoC (or DI)
        container, application components (target) define their dependencies on other collaborator (dependee) components via
        metadata. The IoC container is then responsible for the instantiation and injection of the necessary collaborator
        objects into those target application components when they are referenced (or accessed) at runtime. This process is
        the inverse (hence the name, Inversion of Control) of the target application components themselves instantiating
        and/or looking up their dependencies.</p>
      <p>In other words, the core principle of the IoC (or DI) pattern is that the application components should not be 
        responsible for either the creation (via new) or the lookup of the collaborator components, rather have the IoC
        container manage the lifecycle and dependencies of the collaborator components at runtime. This results in a
        very flexible architecture (for example, one can choose different implementations of collaborator components at
        runtime).</p>
    </div>
    <div id="step-div">
      <p>Setup</p>
    </div>
    <div id="para-div">
      <p>The setup will be on a <span class="bold">Ubuntu 18.04 LTS</span> based Linux desktop. Ensure at least
        <span class="bold">Java 8</span> or above is installed and setup. Also, ensure <a href="http://maven.apache.org/"
        target="_blank"><span class="hi-yellow">Apache Maven</span></a> is installed and setup.</p>
      <p>The current version of <span class="bold">Spring Framework</span> at the time of this article is
        <span class="hi-green">5.1.8</span>.</p>
      <p>The following is the listing for the <span class="bold">Maven</span> project file
        <span class="hi-green">pom.xml</span> that will be used:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>pom.xml</legend>
      <pre>&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;com.polarsparc&lt;/groupId&gt;
  &lt;artifactId&gt;springframework&lt;/artifactId&gt;
  &lt;version&gt;1.0&lt;/version&gt;
  &lt;name&gt;SpringFramework&lt;/name&gt;

  &lt;build&gt;
    &lt;pluginManagement&gt;
      &lt;plugins&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
          &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.4&lt;/version&gt;
          &lt;configuration&gt;
            &lt;fork&gt;true&lt;/fork&gt;
            &lt;meminitial&gt;128m&lt;/meminitial&gt;
            &lt;maxmem&gt;512m&lt;/maxmem&gt;
            &lt;source&gt;1.8&lt;/source&gt;
            &lt;target&gt;1.8&lt;/target&gt;
          &lt;/configuration&gt;
        &lt;/plugin&gt;
      &lt;/plugins&gt;
    &lt;/pluginManagement&gt;
  &lt;/build&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
        &lt;version&gt;5.1.8.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;version&gt;5.1.8.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
        &lt;version&gt;5.1.8.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;commons-logging&lt;/groupId&gt;
        &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;    
    &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;3.8.1&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/project&gt;</pre>
    </fieldset>
    <div id="step-div">
      <p>Hands-on with Spring Framework Core - 1</p>
    </div>
    <div id="para-div">
      <p>The core of <span class="bold">Spring Framework</span> is the IoC (or DI) container. It is responsible for
        managing the lifecycle (creation, initialization, usage, destruction) of the application objects (referred
        to as <span class="bold">bean</span>s) and wiring up the dependencies (collaborator beans).</p>
      <p>This brings two questions to mind:</p>
      <ul id="blue-disc-ul">
        <li><p><span class="bold">Beans</span> &#8680; Is there anything special about the application beans ?</p></li>
        <li><p><span class="bold">Dependencies</span> &#8680; How does the <span class="bold">Spring Framework</span> know
          about the bean dependencies</p></li>
      </ul>
      <p>To answer the first question - there is nothing special about the application objects (or beans) - they are just
        plain old <span class="bold">Java</span> objects (or <span class="bold">POJO</span>s).</p>
      <p>To answer the second question - one must provide configuration information about the application beans and their
        dependencies to <span class="bold">Spring Framework</span> via configuration metadata. The configuration metadata
        can be provided via one of the following 3 approaches:</p>
      <ul id="blue-disc-ul">
        <li><p><span class="bold">XML based</span> &#8680; Configuration metadata is specified via XML files. This is how it
          all started and still supported, but however, they are not the preferred method at the current times</p></li>
        <li><p><span class="bold">Annotation based</span> &#8680; Configuration metadata is specified using annotations in the
          application POJOs. There is still an external XML file to enable annotation scanning and processing</p></li>
        <li><p><span class="bold">JavaConfig based</span> &#8680; Configuration metadata is specified using POJO classes
          and some annotations without the need for any external XML file for scanning and processing annotations. This is
          the preferred method currently</p></li>
      </ul>
    </div>
    <div id="para-div">
      <p>We will demonstrate each of the 3 approaches using a simple <span class="bold">Hello</span> greeter example.</p>
    </div>
    <table id="step-table">
      <tbody>
        <tr>
          <td class="text-td">XML based Approach</td>
          <td class="pointer-td"></td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>The simple <span class="bold">Hello</span> greeter standalone application will output a greetings message for a
        chosen language (English, French, etc) and a specified name. The hello message (for a chosen language) is abstracted
        in the data package, while the greeter is abstracted in the service package.</p>
    </div>
    <div id="para-div">
      <p>The following is the interface <span class="hi-green">WorldHelloDAO</span> from the data package:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>WorldHelloDAO.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   World Hello DAO
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.data;

public interface WorldHelloDAO {
    public String fetch(final String lang);
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The following is the POJO <span class="hi-green">SimpleMemoryWorldHelloDAO</span> from the data package that
        implements the interface <span class="bold">WorldHelloDAO</span> and stores 'Hello' for a predefined set of
        languages (English, French, German, Italian, and Spanish) in a <span class="bold">java.util.Map</span>:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>SimpleMemoryWorldHelloDAO.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Simple Memory World Hello DAO
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.data;

import java.util.Map;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

public class SimpleMemoryWorldHelloDAO implements WorldHelloDAO {
    private static Log LOG = LogFactory.getLog(SimpleMemoryWorldHelloDAO.class);
    
    private Map<String, String> helloByLang = null;
    
    public SimpleMemoryWorldHelloDAO() {
        helloByLang = Stream.of(new String[][] {
            { "english", "Hello" },
            { "french", "Bonjour" },
            { "german", "Guten Tag" },
            { "italian", "Salve" },
            { "spanish", "Hola" }
        }).collect(Collectors.toMap(str -> str[0], str -> str[1]));
        
        LOG.info("Initialized a new instance of SimpleMemoryWorldHelloDAO");
    }
    
    @Override
    public String fetch(String lang) {
        String msg = null;
        
        if (lang != null && lang.trim().isEmpty() == false) {
            msg = helloByLang.get(lang.toLowerCase());
        }
        
        if (msg == null) {
            msg = helloByLang.get("english");
        }
        
        return msg;
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The following is the interface <span class="hi-green">HelloGreeter</span> from the service package:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>HelloGreeter.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Hello Greeter
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.service;

public interface HelloGreeter {
    public String greetings(final String lang, final String name);
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The following is the POJO <span class="hi-green">SimpleHelloGreeter</span> from the service package that
        implements the interface <span class="bold">HelloGreeter</span>. It returns a greetings message that consists
        of the 'Hello' for the chosen language and the specified name, separated by a desired separator:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>SimpleHelloGreeter.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Simple Hello Greeter
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.service;

import com.polarsparc.springframework.data.WorldHelloDAO;

public class SimpleHelloGreeter implements HelloGreeter {
    private static String SPACE = " ";
    private static String STRANGER = "Stranger";
    
    private String separator = null;
    
    private WorldHelloDAO worldHello = null;
    
    public SimpleHelloGreeter() {
    }
    
    public String getSeparator() {
        return separator;
    }

    public void setSeparator(String separator) {
        this.separator = separator;
    }

    public WorldHelloDAO getWorldHello() {
        return worldHello;
    }

    public void setWorldHello(WorldHelloDAO worldHello) {
        this.worldHello = worldHello;
    }

    @Override
    public String greetings(String lang, String name) {
        String msg = null;
        
        if (name != null && name.trim().isEmpty() == false) {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(name)
                      .toString();
        }
        else {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(STRANGER)
                      .toString();
        }
        
        return msg;
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The following XML file <span class="hi-green">sample1-beans.xml</span> specifies the configuration metadata
        for the <span class="bold">Spring Framework</span> IoC container:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>sample1-beans.xml</legend>
      <pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;
                        
    &lt;bean id="simpleWorldHello" class="com.polarsparc.springframework.data.SimpleMemoryWorldHelloDAO" /&gt;
    
    &lt;bean name="simpleHelloGreeter" class="com.polarsparc.springframework.service.SimpleHelloGreeter"&gt;
        &lt;property name="separator" value=":" /&gt;
        &lt;property name="worldHello" ref="simpleWorldHello" /&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</pre>
    </fieldset>
    <div id="para-div">
      <p>The root element <span class="hi-green">&lt;beans&gt;</span> indicates the XML namespaces as well as the XML
        Schema (XSD) entities used. For this example, we only need the <span class="hi-yellow">spring-beans</span>
        XSD. See <span class="bold">Figure.1</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-01.png" alt="Beans XSD" />
      <div class="img-cap">Figure.1</div>
    </div>
    <div id="para-div">
      <p>Each application POJO (or bean) must be defined as a <span class="hi-green">&lt;bean&gt;</span> element under
        the root element. It must specify either an <span class="hi-blue">id</span> or a <span class="hi-blue">name</span>
        attribute and a <span class="hi-blue">class</span> attribute. See <span class="bold">Figure.2</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-02.png" alt="Bean id and class" />
      <div class="img-cap">Figure.2</div>
    </div>
    <div id="para-div">
      <p>From the POJO <span class="bold">SimpleHelloGreeter</span>, we can infer that there is a setter method for
        injecting a separator (<span class="hi-blue">setSeparator(String)</span>). To inject a primitive value, use
        the <span class="hi-green">&lt;property&gt;</span> element under the <span class="bold">&lt;bean&gt;</span>
        element with a <span class="hi-blue">name</span> and a <span class="hi-blue">value</span> attribute.</p>
      <p>Similarly, we can infer that there is a setter method for injecting the collaborator bean <span class="bold">
        WorldHelloDAO</span> (<span class="hi-blue">setWorldHello(WorldHelloDAO)</span>). To inject a reference to
        an object, use the <span class="hi-green">&lt;property&gt;</span> element under the <span class="bold">
        &lt;bean&gt;</span> element with a <span class="hi-blue">name</span> and a <span class="hi-blue">ref</span>
        attribute. The <span class="bold">ref</span> attribute must point to a bean <span class="bold">id</span> or
        <span class="bold">name</span>. See <span class="bold">Figure.3</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-03.png" alt="Bean Injection" />
      <div class="img-cap">Figure.3</div>
    </div>
    <div id="para-div">
      <p>Now that we have got the application POJOs and the configuration metadata defined in an XML file, it is time
        to bring them together into the <span class="bold">Spring Framework</span> IoC container as a standalone
        <span class="bold">Java</span> application.</p>
    </div>
    <div id="para-div">
      <p>The following is the <span class="bold">Spring Framework</span> application <span class="hi-green">Sample1</span>:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>Sample1.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Sample 1
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.polarsparc.springframework.service.HelloGreeter;

public class Sample1 {
    private static Log LOG = LogFactory.getLog(Sample1.class);

    public static void main(String[] args) {
        @SuppressWarnings("resource")
        ApplicationContext applicationContext =
            new ClassPathXmlApplicationContext("/sample1-beans.xml");
        
        HelloGreeter greeter = applicationContext.getBean("simpleHelloGreeter", HelloGreeter.class);
        
        LOG.info(greeter.greetings("spanish", "Bull"));
        LOG.info(greeter.greetings("italian", "Fox"));
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>Let us explain and understand the code from <span class="bold">Sample01</span> listed above.</p>
      <ul id="blue-sqr-ul">
        <li>
          <p>The interface <span class="hi-yellow">ApplicationContext</span> is the core of <span class="bold">Spring
            Framework</span> and represents <span class="underbold">the IoC container</span>. It provides access to the
            configuration information about all the beans being managed by the container as well as references to their
            instances.</p>
        </li>
        <li>
          <p>The class <span class="hi-yellow">ClassPathXmlApplicationContext</span> is one of the concrete implementations
            of the interface <span class="bold">ApplicationContext</span> that reads an XML based configuration metadata
            file from the classpath and creates an instance of a <span class="bold">Spring Framework</span> IoC container.</p>
        </li>
        <li>
          <p>The method <span class="hi-blue">getBean(String, Class)</span> on an instance of <span class="bold">
            ApplicationContext</span> returns the reference to the bean with String id and of type Class. In this example,
            we are looking for a bean with id <span class="bold">simpleHelloGreeter</span> of type <span class="bold">
            HelloGreeter.class</span></p>
        </li>
      </ul>
    </div>
    <div id="para-div">
      <p>Executing the Java program <span class="bold">Sample01</span> listed above should generate an output similar to
        the following:</p>
    </div>
    <div id="out-div">
      <h4>Output.1</h4>
      <pre>Jul 05, 2019 8:58:22 PM com.polarsparc.springframework.data.SimpleMemoryWorldHelloDAO <init>
INFO: Initialized a new instance of SimpleMemoryWorldHelloDAO
Jul 05, 2019 8:58:22 PM com.polarsparc.springframework.Sample1 main
INFO: Hola: Bull
Jul 05, 2019 8:58:22 PM com.polarsparc.springframework.Sample1 main
INFO: Salve: Fox</pre>
    </div>
    <table id="step-table">
      <tbody>
        <tr>
          <td class="text-td">Annotation based Approach</td>
          <td class="pointer-td"></td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>The interface <span class="bold">WorldHelloDAO</span> from the data package has no change and remains the same.</p>
    </div>
    <div id="para-div">
      <p>The following is the POJO <span class="hi-green">SimpleMemoryWorldHelloDAO2</span> from the data package that
        implements the interface <span class="bold">WorldHelloDAO</span> and stores 'Hello' for a predefined set of
        languages (English, French, German, Italian, and Spanish) in a <span class="bold">java.util.Map</span>:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>SimpleMemoryWorldHelloDAO2.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Simple Memory World Hello DAO 2
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.data;

import java.util.Map;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.stereotype.Repository;

@Repository
public class SimpleMemoryWorldHelloDAO2 implements WorldHelloDAO {
    private static Log LOG = LogFactory.getLog(SimpleMemoryWorldHelloDAO2.class);
    
    private Map<String, String> helloByLang = null;
    
    public SimpleMemoryWorldHelloDAO2() {
        helloByLang = Stream.of(new String[][] {
            { "english", "Hello" },
            { "french", "Bonjour" },
            { "german", "Guten Tag" },
            { "italian", "Salve" },
            { "spanish", "Hola" }
        }).collect(Collectors.toMap(str -> str[0], str -> str[1]));
        
        LOG.info("Initialized a new instance of SimpleMemoryWorldHelloDAO2");
    }
    
    @Override
    public String fetch(String lang) {
        String msg = null;
        
        if (lang != null && lang.trim().isEmpty() == false) {
            msg = helloByLang.get(lang.toLowerCase());
        }
        
        if (msg == null) {
            msg = helloByLang.get("english");
        }
        
        return msg;
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>Notice the use of the annotation <span class="hi-yellow">@Repository</span> in the code <span class="bold">
        SimpleMemoryWorldHelloDAO2</span> above. This is a class level annotation and is typically used on persistence
        layer objects (or DAOs). This annotation is a specialized form of the annotation <span class="hi-yellow">
        @Component</span>, which indicates a POJO as an application component (or bean) to the <span class="bold">
        Spring Framework</span> IoC container. We could have used the annotation <span class="bold">@Component</span>
        instead and it would have been valid. See <span class="bold">Figure.4</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-04.png" alt="Repository Annotation" />
      <div class="img-cap">Figure.4</div>
    </div>
    <div id="para-div">
      <p>The interface <span class="bold">HelloGreeter</span> from the service package has no change and remains the same.</p>
    </div>
    <div id="para-div">
      <p>The following is the POJO <span class="hi-green">SimpleHelloGreeter2</span> from the service package that
        implements the interface <span class="bold">HelloGreeter</span>. It returns a greetings message that consists
        of the 'Hello' for the chosen language and the specified name, separated by a desired separator:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>SimpleHelloGreeter2.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Simple Hello Greeter 2
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;

import com.polarsparc.springframework.data.WorldHelloDAO;

@Service("simpleHelloGreeter")
public class SimpleHelloGreeter2 implements HelloGreeter {
    private static String SPACE = " ";
    private static String STRANGER = "Stranger";
    
    private String separator = null;
    
    private WorldHelloDAO worldHello = null;
    
    public SimpleHelloGreeter2() {
    }
    
    public String getSeparator() {
        return separator;
    }

    @Value("${env.greeter.sep:-}")
    public void setSeparator(String separator) {
        this.separator = separator;
    }

    public WorldHelloDAO getWorldHello() {
        return worldHello;
    }

    @Autowired
    public void setWorldHello(WorldHelloDAO worldHello) {
        this.worldHello = worldHello;
    }

    @Override
    public String greetings(String lang, String name) {
        String msg = null;
        
        if (name != null && name.trim().isEmpty() == false) {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(name)
                      .toString();
        }
        else {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(STRANGER)
                      .toString();
        }
        
        return msg;
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>Notice the use of 3 new annotations <span class="hi-yellow">@Service</span>, <span class="hi-yellow">@Value</span>,
        and <span class="hi-yellow">@Autowired</span> in the code <span class="bold">SimpleHelloGreeter2</span> above.</p>
    </div>
    <div id="para-div">
      <p><span class="bold">@Service</span> is a class level annotation and is typically used on service layer objects.
        Just like the annotation <span class="bold">@Repository</span>, this annotation is a specialized form of the
        annotation <span class="bold">@Component</span>. The value inside the <span class="bold">@Service</span> annotation
        specifies the bean id. By default, the uncapitalized non-qualified class name is the bean id. We could have used
        the annotation <span class="bold">@Component</span> instead and it would have been valid. See <span class="bold">
        Figure.5</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-05.png" alt="Service Annotation" />
      <div class="img-cap">Figure.5</div>
    </div>
    <div id="para-div">
      <p><span class="bold">@Value</span> can be a member level or a method level annotation. The recommended approach
        is to use at the method level (on a setter method) for testability reasons. This annotation is used to inject a
        value into a member field. The value inside the <span class="bold">@Value</span> annotation could be a primitive
        String value or a reference to a system property name enclosed between "${" and "}". In this example, the system
        property name is <span class="bold">env.greeter.sep</span>. The colon after the system property name specifies a
        default value. In other words, it is of the form "${system-property-name:default-value}". See <span class="bold">
        Figure.6</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-06.png" alt="Value Annotation" />
      <div class="img-cap">Figure.6</div>
    </div>
    <div id="para-div">
      <p><span class="bold">@Autowired</span> can be a member level or a method level annotation. The recommended
        approach is to use at the method level (on a setter method) for testability reasons. This indicates to the IoC
        container to automatically inject (or auto wire) a reference to an instance of a bean of type that is similar to
        that of the method parameter. In this example, the IoC container will inject (or auto wire) an instance of a bean
        of type <span class="bold">WorldHelloDAO</span> via the setter method
        <span class="hi-blue">setWorldHello(WorldHelloDAO)</span>. See <span class="bold">Figure.7</span> below.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-07.png" alt="Autowired Annotation" />
      <div class="img-cap">Figure.7</div>
    </div>
    <div id="para-div">
      <p>The following XML file <span class="hi-green">sample2-beans.xml</span> indicates to the <span class="bold">
        Spring Framework</span> IoC container that it perform component scanning at the specified package level for
        annotation processing:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>sample2-beans.xml</legend>
      <pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd"&gt;

    &lt;context:component-scan base-package="com.polarsparc.springframework.data" /&gt;
    &lt;context:component-scan base-package="com.polarsparc.springframework.service" /&gt;                        
&lt;/beans&gt;</pre>
    </fieldset>
    <div id="para-div">
      <p>Notice the addition of <span class="hi-green">context</span> namespace as well as the corresponding XML Schema
        XSD (<span class="hi-yellow">spring-context</span>).</p>
      <p>The <span class="hi-green">&lt;context:component-scan&gt;</span> element specifies the <span class="bold">Java</span>
        package that needs to be scanned for annotations. Each <span class="bold">Java</span> package will have its own line
        in the XML file. In our example, it is the data and service packages.</p>
    </div>
    <div id="para-div">
      <p>The following is the <span class="bold">Spring Framework</span> application <span class="hi-green">Sample2</span>:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>Sample2.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Sample 2
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.GenericXmlApplicationContext;

import com.polarsparc.springframework.service.HelloGreeter;

public class Sample2 {
    private static Log LOG = LogFactory.getLog(Sample2.class);

    public static void main(String[] args) {
        @SuppressWarnings("resource")
        ApplicationContext applicationContext =
            new GenericXmlApplicationContext("/sample2-beans.xml");
        
        HelloGreeter greeter = applicationContext.getBean("simpleHelloGreeter", HelloGreeter.class);
        
        LOG.info(greeter.greetings("English", "Cat"));
        LOG.info(greeter.greetings("German", "Tiger"));
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The class <span class="hi-yellow">GenericXmlApplicationContext</span> is another concrete implementations of the
        interface <span class="bold">ApplicationContext</span> that reads an XML based configuration file from the classpath
        and creates an instance of a <span class="bold">Spring Framework</span> IoC container. Since the XML file has no
        bean definitions and only specifies the <span class="bold">context:component-scan</span> element, this triggers
        scanning of POJOs (components) in the classpath (for the specified <span class="bold">Java</span> packages) for
        annotation processing and auto wiring.</p>
    </div>
    <div id="para-div">
      <p>Executing the Java program <span class="bold">Sample02</span> listed above with the system property <span class="bold">
        -Denv.greeter.sep=","</span> should generate an output similar to the following:</p>
    </div>
    <div id="out-div">
      <h4>Output.2</h4>
      <pre>Jul 05, 2019 9:10:21 PM com.polarsparc.springframework.data.SimpleMemoryWorldHelloDAO2 <init>
INFO: Initialized a new instance of SimpleMemoryWorldHelloDAO2
Jul 05, 2019 9:10:21 PM com.polarsparc.springframework.Sample2 main
INFO: Hello, Cat
Jul 05, 2019 9:10:21 PM com.polarsparc.springframework.Sample2 main
INFO: Guten Tag, Tiger</pre>
    </div>
    <table id="step-table">
      <tbody>
        <tr>
          <td class="text-td">JavaConfig based Approach</td>
          <td class="pointer-td"></td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>The interface <span class="bold">WorldHelloDAO</span> as well as its implementation POJO <span class="bold">
        SimpleMemoryWorldHelloDAO</span> from the data package have no changes and remains the same.</p>
    </div>
    <div id="para-div">
      <p>The interface <span class="bold">HelloGreeter</span> from the service package has no change and remains the
        same.</p>
    </div>
    <div id="para-div">
      <p>The following is the POJO <span class="hi-green">SimpleHelloGreeter3</span> from the service package that
        implements the interface <span class="bold">HelloGreeter</span>. It returns a greetings message that consists
        of the 'Hello' for the chosen language and the specified name, separated by a desired separator:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>SimpleHelloGreeter3.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Simple Hello Greeter 3
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;

import com.polarsparc.springframework.data.WorldHelloDAO;

public class SimpleHelloGreeter3 implements HelloGreeter {
    private static String SPACE = " ";
    private static String STRANGER = "Stranger";
    
    private String separator = null;
    
    private WorldHelloDAO worldHello = null;
    
    public SimpleHelloGreeter3() {
    }
    
    public String getSeparator() {
        return separator;
    }

    @Value("${env.greeter.sep:-}")
    public void setSeparator(String separator) {
        this.separator = separator;
    }

    public WorldHelloDAO getWorldHello() {
        return worldHello;
    }

    @Autowired
    public void setWorldHello(WorldHelloDAO worldHello) {
        this.worldHello = worldHello;
    }

    @Override
    public String greetings(String lang, String name) {
        String msg = null;
        
        if (name != null && name.trim().isEmpty() == false) {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(name)
                      .toString();
        }
        else {
            msg = new StringBuilder()
                      .append(worldHello.fetch(lang.toLowerCase()))
                      .append(separator)
                      .append(SPACE)
                      .append(STRANGER)
                      .toString();
        }
        
        return msg;
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>Notice we only use 2 of the annotations <span class="bold">@Value</span> and <span class="bold">@Autowired</span>
        in the code <span class="bold">SimpleHelloGreeter3</span> above.</p>
    </div>
    <div id="para-div">
      <p>We need a <span class="bold">Java</span> class that will be used to specify the configuration metadata about the
        different application components (or beans). This configuration class will be abstracted in the config package.</p>
    </div>
    <div id="para-div">
      <p>The following is the <span class="bold">JavaConfig</span> POJO <span class="hi-green">Sample3Config</span> from
        the config package:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>Sample3Config.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Sample 3 Config
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.polarsparc.springframework.data.SimpleMemoryWorldHelloDAO;
import com.polarsparc.springframework.data.WorldHelloDAO;
import com.polarsparc.springframework.service.HelloGreeter;
import com.polarsparc.springframework.service3.SimpleHelloGreeter3;

@Configuration
public class Sample3Config {
    @Bean
    public WorldHelloDAO simpleWorldHello() {
        return new SimpleMemoryWorldHelloDAO();
    }
    
    @Bean
    public HelloGreeter simpleHelloGreeter() {
        return new SimpleHelloGreeter3();
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>Notice the use of 2 new annotations <span class="hi-yellow">@Configuration</span> and <span class="hi-yellow">
        @Bean</span> in the code <span class="bold">Sample3Config</span> above.</p>
      <p><span class="bold">@Configuration</span> is a class level annotation and is used to tag a class as the source of
        bean definitions. It is similar to the XML element <span class="bold">&lt;beans&gt;</span> from the XML based
        configuration metadata file. See <span class="bold">Figure.8</span> below in red.</p>
      <p><span class="bold">@Bean</span> is a method level annotation and correspond to the XML element <span class="bold">
        &lt;bean&gt;</span> from the XML based configuration metadata file. By default, the method name is used as the
        <span class="bold">name</span> of the bean. See <span class="bold">Figure.8</span> below in blue.</p>
    </div>
    <div id="img-outer-div"> <img class="img-cls" src="./images/springframework-08.png" alt="Configuration and Bean" />
      <div class="img-cap">Figure.8</div>
    </div>
    <div id="para-div">
      <p>The following is the <span class="bold">Spring Framework</span> application <span class="hi-green">Sample3</span>:</p>
    </div>
    <fieldset id="sc-fieldset"> <legend>Sample3.java</legend>
      <pre>/*
 * Topic:  Spring Framework Core Essentials
 * 
 * Name:   Sample 3
 * 
 * Author: Bhaskar S
 * 
 * URL:    https://polarsparc.github.io
 */

package com.polarsparc.springframework;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import com.polarsparc.springframework.config.Sample3Config;
import com.polarsparc.springframework.service.HelloGreeter;

public class Sample3 {
    private static Log LOG = LogFactory.getLog(Sample3.class);

    public static void main(String[] args) {
        @SuppressWarnings("resource")
        ApplicationContext applicationContext =
            new AnnotationConfigApplicationContext(Sample3Config.class);
        
        HelloGreeter greeter = applicationContext.getBean("simpleHelloGreeter", HelloGreeter.class);
        
        LOG.info(greeter.greetings("french", "Dog"));
        LOG.info(greeter.greetings("italian", "Snake"));
    }
}</pre>
    </fieldset>
    <div id="para-div">
      <p>The class <span class="hi-yellow">AnnotationConfigApplicationContext</span> is another concrete implementations of
        the interface <span class="bold">ApplicationContext</span> that parses the configuration metadata from the specified
        configuration class and creates an instance of a <span class="bold">Spring Framework</span> IoC container. Internally
        it scans of POJOs (components) in the classpath for annotation processing and auto wiring.</p>
    </div>
    <div id="para-div">
      <p>Executing the Java program <span class="bold">Sample03</span> listed above should generate an output similar to
        the following:</p>
    </div>
    <div id="out-div">
      <h4>Output.3</h4>
      <pre>Jul 05, 2019 10:12:17 PM com.polarsparc.springframework.data.SimpleMemoryWorldHelloDAO <init>
INFO: Initialized a new instance of SimpleMemoryWorldHelloDAO
Jul 05, 2019 10:12:17 PM com.polarsparc.springframework.Sample3 main
INFO: Bonjour- Dog
Jul 05, 2019 10:12:17 PM com.polarsparc.springframework.Sample3 main
INFO: Salve- Snake</pre>
    </div>
    <div id="para-div">
      <p>We did not pass the system property <span class="bold">-Denv.greeter.sep=","</span> when executing the Java program
        <span class="bold">Sample03</span> and hence it used the default separator "-".</p>
    </div>
    <div id="para-div">
      <p>More to be covered in the next part of this series ...</p>
    </div>
    <div id="step-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p>[1] <span class="bold"></span><a href="https://spring.io/projects/spring-framework" target="_blank"><span class="bold">Spring Framework</span></a></p>
      <p>[2] <span class="bold"></span><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html" target="_blank"><span class="bold">Spring Framework Core</span></a></p>
      <p>[3] <span class="bold"></span><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/overview-summary.html" target="_blank"><span class="bold">Spring Framework API</span></a></p>
    </div>
    <br/>
    <hr class="line-hr" />
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
