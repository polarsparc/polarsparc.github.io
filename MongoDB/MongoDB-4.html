<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=windows-1252" />
    <meta name="author" content="Bhaskar.S">
    <meta name="description" content="Hands-on MongoDB :: Part-4">
    <meta name="subject" content="Hands-on MongoDB :: Part-4">
    <meta name="keywords" content="mongodb, nosql">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <title>Hands-on MongoDB :: Part-4</title>
    <link href="../css/polarsparc-v2.4.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <br/>
    <table borber="0">
      <tr>
        <td valign="bottom"><span id="ps-home"></span></td>
        <td valign="bottom"><span id="home-a"><a id="home-a" href="https://polarsparc.github.io/">PolarSPARC</a></span></td>
      </tr>
    </table>
    <br/>
    <div id="title-div">
      <p>Hands-on MongoDB :: Part-4</p>
    </div>
    <br />
    <table id="ad-table">
      <tbody>
        <tr>
          <td class="author-td">Bhaskar S</td>
          <td class="date-td">02/13/2021 (<span class="hi-yellow">UPDATED</span>)</td>
        </tr>
      </tbody>
    </table>
    <hr class="line-hr" /> <br />
    <div id="section-div">
      <p>Introduction</p>
    </div>
    <div id="para-div">
      <p>In <a href="https://polarsparc.github.io/MongoDB/MongoDB-1.html" target="_blank"><span class="bold">Part-1</span></a>, we setup
        the high-availability 3-node cluster using <span class="bold">Docker</span> and got our hands dirty with MongoDB by using the
        <span class="bold">mongo</span> command-line interface.</p>
      <p>In <a href="https://polarsparc.github.io/MongoDB/MongoDB-2.html" target="_blank"><span class="bold">Part-2</span></a>, we got to
        demonstrate the same set of operations on MongoDB using the programming language drivers for <span class="bold">Java</span>
        and <span class="bold">Python</span>.</p>
      <p>In <a href="https://polarsparc.github.io/MongoDB/MongoDB-3.html" target="_blank"><span class="bold">Part-3</span></a>, we got to
        demonstrate the same set of operations on MongoDB using <span class="bold">Spring Boot</span> with <span class="bold">Java
        </span>.</p>
      <p>In this part, we will explore more advanced operators for querying and updating MongoDB using the <span class="bold">mongo
        </span> command-line interface.</p>
    </div>
    <div id="section-div">
      <p>Hands-on with MongoDB</p>
    </div>
    <div id="para-div">
      <p>Let us create a sample dataset for the purposes of demonstration. The sample dataset will have three collections, namely,
        <span class="hi-grey">products</span>, <span class="hi-grey">users</span>, and <span class="hi-grey">reviews</span>. We will
        populate few documents in these collections.</p>
      <p>An easy way to create the sample dataset is to list all the commands in a file with <span class="bold">.js</span> extension
        and execute that file using the <span class="bold">mongo</span> client.</p>
      <p>The following are the contents of the file <span class="hi-yellow">my_mongo.js</span> (which will be placed in the directory
        <span class="bold">$HOME/Downloads/DATA/mongodb</span>) and lists all the commands to create our sample dataset.</p>
    </div>
    <br/>
    <div id="src-outer-div-1">
      <div class="src-cap-1">my_mongo.js</div>
      <div class="src-body-1">
<pre>db.products.drop();
db.users.drop();
db.reviews.drop();

db.products.insert({ '_id': 'ipad_air3_64', 'name': 'Apple iPad Air 3rd Gen 64G Wifi', 'price': 599.00, 'quantity': 5, 'category': ['electronics', 'tablet', 'apple'] });
db.products.insert({ '_id': 'kindle_hdx_32', 'name': 'Amazon Kindle 8.9 HDX 32G Wifi', 'price': 99.00, 'quantity': 6, 'category': ['electronics', 'tablet', 'amazon'] });
db.products.insert({ '_id': 'iwatch_6_44', 'name': 'Apple iWatch 6 Wifi 44mm', 'price': 899.00, 'quantity': 8, 'category': ['electronics', 'wearable', 'apple'] });
db.products.insert({ '_id': 'nikon_z6', 'name': 'Nikon Z6', 'price': 1299.00, 'quantity': 3, 'category': ['electronics', 'camera', 'mirrorless', 'nikon'] });
db.products.insert({ '_id': 'canon_r5', 'name': 'Canon R5', 'price': 3899.00, 'quantity': 5, 'category': ['electronics', 'camera', 'mirrorless', 'canon'] });
db.products.insert({ '_id': 'mongo_def', 'name': 'MongoDB, The Definitive Guide', 'price': 39.99, 'quantity': 9, 'category': ['books', 'technology', 'oreilly'] });
db.products.insert({ '_id': 'mongo_action', 'name': 'MongoDB in Action', 'price': 49.99, 'quantity': 6, 'category': ['books', 'technology', 'manning'] });
db.products.insert({ '_id': '7_habits', 'name': 'The 7 Habits of Highly Effective People', 'price': 19.99, 'quantity': 11, 'category': ['books', 'audiobook', 'business', 'leadership'] });
db.products.insert({ '_id': 'my_cheese', 'name': 'Who Moved My Cheese', 'price': 8.99, 'quantity': 4, 'category': ['books', 'business', 'self-help'] });

db.users.insert({ '_id': 'alice', 'first': 'Alice', 'last': 'Thompson', 'contact': { 'email': 'alicet@smart.com', 'phone': '123-456-7890', 'zip': '10001' } });
db.users.insert({ '_id': 'bob', 'first': 'Bob', 'last': 'Jones', 'contact': { 'email': 'bob.jones@tall.com', 'phone': '987-654-3210', 'zip': '10002' } });
db.users.insert({ '_id': 'charlie', 'first': 'Charlie', 'last': 'Lee', 'contact': { 'email': 'c_lee@hard.com', 'phone': '234-567-8901', 'zip': '10003' } });
db.users.insert({ '_id': 'frank', 'first': 'Frank', 'last': 'Smith', 'contact': { 'email': 'fsmith@doe.com', 'phone': '987-456-1111', 'zip': '10002' } });
db.users.insert({ '_id': 'george', 'first': 'George', 'last': 'Baker', 'contact': { 'email': 'g_baker@sharp.com', 'phone': '123-654-0987', 'zip': '10001' } });

db.reviews.insert( { 'user_id': 'alice', 'product_id': 'nikon_z6', 'created': new Date(2020, 6, 15), 'rating': 4, 'comments': 'Good mirrorless' } );
db.reviews.insert( { 'user_id': 'alice', 'product_id': 'mongo_def', 'created': new Date(2018, 3, 11), 'rating': 5, 'comments': 'Great book on Mongo', 'recommend': 'yes' } );
db.reviews.insert( { 'user_id': 'alice', 'product_id': 'my_cheese', 'created': new Date(2018, 7, 14), 'rating': 4, 'comments': 'Decent book with moral' } );
db.reviews.insert( { 'user_id': 'bob', 'product_id': 'ipad_air3_64', 'created': new Date(2020, 4, 9), 'rating': 5, 'comments': 'The best tablet in the market' } );
db.reviews.insert( { 'user_id': 'bob', 'product_id': 'iwatch_6_44', 'created': new Date(2020, 10, 19), 'rating': 5, 'comments': 'Love this iWatch' } );
db.reviews.insert( { 'user_id': 'charlie', 'product_id': '7_habits', 'created': new Date(2019, 5, 27), 'rating': 5, 'comments': 'Excellent leadership book' } );
db.reviews.insert( { 'user_id': 'charlie', 'product_id': 'my_cheese', 'created': new Date(2018, 10, 24), 'rating': 3, 'comments': 'An ok book for reading' } );
db.reviews.insert( { 'user_id': 'frank', 'product_id': 'canon_r5', 'created': new Date(2020, 7, 29), 'rating': 4, 'comments': 'Good Mirrorless but pricy' } );
db.reviews.insert( { 'user_id': 'frank', 'product_id': 'iwatch_6_44', 'created': new Date(2020, 6, 5), 'rating': 5, 'comments': 'Excellent wearable', 'recommend': 'yes' } );
db.reviews.insert( { 'user_id': 'frank', 'product_id': 'mongo_action', 'created': new Date(2019, 11, 4), 'rating': 3, 'comments': 'Decent book' } );
db.reviews.insert( { 'user_id': 'george', 'product_id': 'kindle_hdx_32', 'created': new Date(2018, 8, 20), 'rating': 5, 'comments': 'Great ebook reader from Amazon' } );</pre>
      </div>
    </div>
    <br/>
    <div id="para-div">
      <p>Notice that each of the documents inserted into the collection <span class="bold">products</span> have a key called
        <span class="hi-yellow">category</span> whose type is an array of values. This is not possible with a relational database.</p>
      <p>Also, take notice of the fact that each of the documents inserted into the collection <span class="bold">users</span> have
        a key called <span class="hi-yellow">contact</span> whose type is an object with its own key-value pairs. This is also not
        possible with a relational database.</p>
    </div>
    <div id="para-div">
      <p>Now, to process the file <span class="bold">$HOME/Downloads/DATA/mongodb/my_mongo.js</span> using the command-line interface
        <span class="bold">mongo</span> (using docker), execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ docker run --rm -it -v $HOME/Downloads/DATA/mongodb/my_mongo.js:/data/my_mongo.js mongo:4.4.3 mongo --host 192.168.1.53 --port 5001 mydb /data/my_mongo.js</p>
    </div>
    <div id="para-div">
      <p>The following will be the output:</p>
    </div>
    <div id="out-div">
      <h4>Output.1</h4>
      <pre>MongoDB shell version v4.4.3
connecting to: mongodb://192.168.1.53:5001/mydb?compressors=disabled&gssapiServiceName=mongodb
Implicit session: session { "id" : UUID("b4533c0d-3317-47f5-a528-c2eca0027fde") }
MongoDB server version: 4.4.3</pre>
    </div>
    <div id="para-div">
      <p>The above output indicates that there were no errors and the file <span class="bold">my_mongo.js</span> was successfully
        processed.</p>
    </div>
    <br/>
    <div id="warn-div">
      <h4>!!! ATTENTION !!!</h4>
      <pre>As indicated in <a href="https://polarsparc.github.io/xhtml/MongoDB-1.html" target="_blank"><span class="bold">Part-1</span></a>, ensure to connect to the <span class="bold">PRIMARY</span> node and not to the SECONDARY node(s)</pre>
    </div>
    <br/>
    <div id="para-div">
      <p>To launch the command-line interactive MongoDB client on the <span class="underbold">PRIMARY</span> node running on the port
        5001 using docker, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>$ docker run --rm -it mongo:4.4.3 mongo --host 192.168.1.53 --port 5001 mydb</p>
    </div>
    <div id="para-div">
      <p>The following will be the output:</p>
    </div>
    <div id="out-div">
      <h4>Output.2</h4>
      <pre>MongoDB shell version v4.4.3
connecting to: mongodb://192.168.1.53:5001/mydb?compressors=disabled&gssapiServiceName=mongodb
Implicit session: session { "id" : UUID("2597330c-c633-4cc4-ab54-9efb1a7a34b2") }
MongoDB server version: 4.4.3
Welcome to the MongoDB shell.
For interactive help, type "help".
For more comprehensive documentation, see
  https://docs.mongodb.com/
Questions? Try the MongoDB Developer Community Forums
  https://community.mongodb.com
---
The server generated these startup warnings when booting: 
        2021-01-23T02:12:39.003+00:00: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine. See http://dochub.mongodb.org/core/prodnotes-filesystem
        2021-01-23T02:12:39.827+00:00: Access control is not enabled for the database. Read and write access to data and configuration is unrestricted
---
---
        Enable MongoDB's free cloud-based monitoring service, which will then receive and display
        metrics about your deployment (disk utilization, CPU, operation statistics, etc).

        The monitoring data will be available on a MongoDB website with a unique URL accessible to you
        and anyone you share the URL with. MongoDB may use this information to make product
        improvements and to suggest MongoDB products and deployment options to you.

        To enable free monitoring, run the following command: db.enableFreeMonitoring()
        To permanently disable this reminder, run the following command: db.disableFreeMonitoring()
---
mongodb-rs:PRIMARY&gt; </pre>
    </div>
    <div id="para-div">
      <p>Let us now list all the collection(s) in a database by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; show collections</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.3</h4>
      <pre>products
reviews
users</pre>
    </div>
    <div id="para-div">
      <p>As can be inferred from the Output.3 above, we have created the three collections <span class="bold">products</span>,
        <span class="bold">users</span>, and <span class="bold">reviews</span> for our sample dataset in the MongoDB database.</p>
    </div>
    <div id="para-div">
      <p>One can query a collection using a key whose type is an array. In our sample dataset, we can query the collection
        <span class="bold">products</span> using the key <span class="bold">category</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'category': 'electronics' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.4</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : [ "electronics", "tablet", "apple" ] }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : [ "electronics", "camera", "mirrorless", "nikon" ] }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : [ "electronics", "camera", "mirrorless", "canon" ] }</pre>
    </div>
    <div id="para-div">
      <p>As can be inferred from the Output.4 above, we are able to retrieve all the documents from the collections <span class="bold">
        products</span> that contain <span class="bold">electronics</span> as one of the values in the array.</p>
    </div>
    <div id="para-div">
      <p>Similarly, one can query a collection using a key whose type is an object (embedded document). In our sample dataset, we can
        query the collection <span class="bold">users</span> using the key <span class="bold">contact.zip</span> by executing the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.find({ 'contact.zip': '10001' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.5</h4>
      <pre>{ "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } }
{ "_id" : "george", "first" : "George", "last" : "Baker", "contact" : { "email" : "g_baker@sharp.com", "phone" : "123-654-0987", "zip" : "10001" } }</pre>
    </div>
    <div id="para-div">
      <p>As can be inferred from the Output.5 above, we are able to retrieve all the documents from the collections <span class="bold">
        users</span> that contain the value <span class="bold">10001</span> for the key <span class="bold">zip</span> of the embedded
        document with key <span class="bold">contact</span>.</p>
    </div>
    <div id="para-div">
      <p>Now. let us move on to the special operators that can be used in a query. Special operators for query in MongoDB begin with
        the <span class="bold">$</span> symbol and represent the various comparison and logical operations as listed in the table
        below.</p>
    </div>
    <table id="col2-table">
      <thead>
        <tr>
          <th>Query Operator</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$gt</span></td>
          <td class="col2-c2-odd">Matches values that are greater than the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$lt</span></td>
          <td class="col2-c2-even">Matches values that are less than the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$gte</span></td>
          <td class="col2-c2-odd">Matches values that are equal to or greater than the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$lte</span></td>
          <td class="col2-c2-even">Matches values that are less than or equal to the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$ne</span></td>
          <td class="col2-c2-odd">Matches all values that are not equal to the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$in</span></td>
          <td class="col2-c2-even">Matches any of the values that exist in the specified array</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$nin</span></td>
          <td class="col2-c2-odd">Matches values that do not exist in the specified array</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$all</span></td>
          <td class="col2-c2-even">Applicable only to array values and matches arrays that contain all specified values</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$not</span></td>
          <td class="col2-c2-odd">Negates the match condition</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$or</span></td>
          <td class="col2-c2-even">Represents the logical OR</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$and</span></td>
          <td class="col2-c2-odd">Represents the logical AND</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$nor</span></td>
          <td class="col2-c2-even">Represents the logical NOR</td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">price</span>
        is greater than <span class="bold">299</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'price': { '$gt': 299 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.6</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : [ "electronics", "tablet", "apple" ] }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : [ "electronics", "camera", "mirrorless", "nikon" ] }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : [ "electronics", "camera", "mirrorless", "canon" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">price</span>
        is less than <span class="bold">10</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'price': { '$lt': 10 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.7</h4>
      <pre>{ "_id" : "my_cheese", "name" : "Who Moved My Cheese", "price" : 8.99, "quantity" : 4, "category" : [ "books", "business", "self-help" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">price</span>
        is greater than <span class="bold">98</span> and less than <span class="bold">200</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'price': { '$gt': 98, '$lt': 200 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.8</h4>
      <pre>{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">price</span>
        is greater than or equal to <span class="bold">10</span> and less than or equal to <span class="bold">399</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'price': { '$gte': 10, '$lte': 399 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.9</h4>
      <pre>{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }
{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : [ "books", "technology", "oreilly" ] }
{ "_id" : "mongo_action", "name" : "MongoDB in Action", "price" : 49.99, "quantity" : 6, "category" : [ "books", "technology", "manning" ] }
{ "_id" : "7_habits", "name" : "The 7 Habits of Highly Effective People", "price" : 19.99, "quantity" : 11, "category" : [ "books", "audiobook", "business", "leadership" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">reviews</span> where the <span class="bold">created</span>
        date is greater than or equal to <span class="bold">1/1/2018</span> and less than or equal to <span class="bold">1/30/2019</span>
        (the month January in <span class="bold">JavaScript</span> is represented as a 0), execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.find({ 'created': { '$gte': new Date(2018, 0, 1), '$lte': new Date(2019, 0, 30) }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.10</h4>
      <pre>{ "_id" : ObjectId("60272963971af82c1c471910"), "user_id" : "alice", "product_id" : "mongo_def", "created" : ISODate("2018-04-11T00:00:00Z"), "rating" : 5, "comments" : "Great book on Mongo", "recommend" : "yes" }
{ "_id" : ObjectId("60272963971af82c1c471914"), "user_id" : "charlie", "product_id" : "my_cheese", "created" : ISODate("2018-11-24T00:00:00Z"), "rating" : 3, "comments" : "An ok book for reading" }
{ "_id" : ObjectId("60272963971af82c1c471918"), "user_id" : "george", "product_id" : "kindle_hdx_32", "created" : ISODate("2018-09-20T00:00:00Z"), "rating" : 5, "comments" : "Great ebook reader from Amazon" }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">users</span> where the <span class="bold">first</span>
        name is not equal to <span class="bold">Bob</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.find({ 'first': { '$ne': 'Bob' }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.11</h4>
      <pre>{ "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } }
{ "_id" : "charlie", "first" : "Charlie", "last" : "Lee", "contact" : { "email" : "c_lee@hard.com", "phone" : "234-567-8901", "zip" : "10003" } }
{ "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } }
{ "_id" : "george", "first" : "George", "last" : "Baker", "contact" : { "email" : "g_baker@sharp.com", "phone" : "123-654-0987", "zip" : "10001" } }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">category</span>
        is in <span class="bold">tablet</span> or <span class="bold">audiobook</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'category': { '$in': ['tablet', 'audiobook'] }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.12</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : [ "electronics", "tablet", "apple" ] }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }
{ "_id" : "7_habits", "name" : "The 7 Habits of Highly Effective People", "price" : 19.99, "quantity" : 11, "category" : [ "books", "audiobook", "business", "leadership" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">category</span>
        is not in <span class="bold">tablet</span> or <span class="bold">audiobook</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'category': { '$nin': ['tablet', 'audiobook'] }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.13</h4>
      <pre>{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : [ "electronics", "camera", "mirrorless", "nikon" ] }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : [ "electronics", "camera", "mirrorless", "canon" ] }
{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : [ "books", "technology", "oreilly" ] }
{ "_id" : "mongo_action", "name" : "MongoDB in Action", "price" : 49.99, "quantity" : 6, "category" : [ "books", "technology", "manning" ] }
{ "_id" : "my_cheese", "name" : "Who Moved My Cheese", "price" : 8.99, "quantity" : 4, "category" : [ "books", "business", "self-help" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">category</span>
        matches both <span class="bold">books</span> and <span class="bold">audiobook</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'category': { '$all': ['books', 'audiobook'] }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.14</h4>
      <pre>{ "_id" : "7_habits", "name" : "The 7 Habits of Highly Effective People", "price" : 19.99, "quantity" : 11, "category" : [ "books", "audiobook", "business", "leadership" ] }</pre>
    </div>
    <div id="para-div">
      <p>Until now all the special operators we used were specified in the value part after the key. The logical operators
        <span class="hi-yellow">$or</span>, <span class="hi-yellow">$and</span>, and <span class="hi-yellow">$nor</span> appear before
        the key.</p>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">category</span>
        matches <span class="bold">tablet</span> OR <span class="bold">mirrorless</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ '$or': [{'category': 'tablet'}, {'category': 'mirrorless'}]})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.15</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : [ "electronics", "tablet", "apple" ] }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : [ "electronics", "camera", "mirrorless", "nikon" ] }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : [ "electronics", "camera", "mirrorless", "canon" ] }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> where the <span class="bold">category</span>
        matches <span class="bold">books</span> AND <span class="bold">technology</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ '$and': [{'category': 'books'}, {'category': 'technology'}]})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.16</h4>
      <pre>{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : [ "books", "technology", "oreilly" ] }
{ "_id" : "mongo_action", "name" : "MongoDB in Action", "price" : 49.99, "quantity" : 6, "category" : [ "books", "technology", "manning" ] }</pre>
    </div>
    <div id="para-div">
      <p>In the following table are some more special operators that are not for comparison or logical operations, but needed for
        some real-world scenarios.</p>
    </div>
    <table id="col2-table">
      <thead>
        <tr>
          <th>Query Operator</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$exist</span></td>
          <td class="col2-c2-odd">Matches documents that have the specified key</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$regex</span></td>
          <td class="col2-c2-even">Matches documents where values match the specified regular expression (in perl format)</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$mod: [m, n]</span></td>
          <td class="col2-c2-odd">Performs a modulo operation on the value of the specified key and matches documents with a specified
            result. This operator takes 2 parameters - the number to divide by (m) and the remainder (n)</td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">reviews</span> that contain the key <span class="bold">
        recommend</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.find({ 'recommend': { $exists: true }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.17</h4>
      <pre>{ "_id" : ObjectId("60272963971af82c1c471910"), "user_id" : "alice", "product_id" : "mongo_def", "created" : ISODate("2018-04-11T00:00:00Z"), "rating" : 5, "comments" : "Great book on Mongo", "recommend" : "yes" }
{ "_id" : ObjectId("60272963971af82c1c471916"), "user_id" : "frank", "product_id" : "iwatch_6_44", "created" : ISODate("2020-07-05T00:00:00Z"), "rating" : 5, "comments" : "Excellent wearable", "recommend" : "yes" }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">reviews</span> for which <span class="bold">comments</span>
        contains the text <span class="bold">excellent</span> (ignoring the case), execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.find({ 'comments': { '$regex': 'excellent', '$options': 'i' }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.18</h4>
      <pre>{ "_id" : ObjectId("60272963971af82c1c471913"), "user_id" : "charlie", "product_id" : "7_habits", "created" : ISODate("2019-06-27T00:00:00Z"), "rating" : 5, "comments" : "Excellent leadership book" }
{ "_id" : ObjectId("60272963971af82c1c471916"), "user_id" : "frank", "product_id" : "iwatch_6_44", "created" : ISODate("2020-07-05T00:00:00Z"), "rating" : 5, "comments" : "Excellent wearable", "recommend" : "yes" }</pre>
    </div>
    <div id="para-div">
      <p>To query all the documents from the collection <span class="bold">products</span> for which the <span class="bold">quantity
        </span> is an even number, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.find({ 'quantity': { '$mod': [2, 0] }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.19</h4>
      <pre>{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] }
{ "_id" : "mongo_action", "name" : "MongoDB in Action", "price" : 49.99, "quantity" : 6, "category" : [ "books", "technology", "manning" ] }
{ "_id" : "my_cheese", "name" : "Who Moved My Cheese", "price" : 8.99, "quantity" : 4, "category" : [ "books", "business", "self-help" ] }</pre>
    </div>
    <div id="para-div">
      <p>To display the count of documents from the collection <span class="bold">reviews</span> with <span class="bold">rating</span>
        of <span class="bold">4</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.count({ 'rating': 4 })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.20</h4>
      <pre>3</pre>
    </div>
    <div id="para-div">
      <p>To query all the distinct values of <span class="bold">rating</span> in the collection <span class="bold">reviews</span>,
        execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.distinct('rating')</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.21</h4>
      <pre>[ 3, 4, 5 ]</pre>
    </div>
    <div id="para-div">
      <p>Now let us move on to the special operators that can be used with an update. As with the query operators, the special
        operators for update also begin with the <span class="bold">$</span> symbol and are as listed in the table below.</p>
    </div>
    <table id="col2-table">
      <thead>
        <tr>
          <th>Update Operator</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$inc</span></td>
          <td class="col2-c2-odd">Increments the value of the specified key by the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$set</span></td>
          <td class="col2-c2-even">Sets the value of the specified key. If the specified key does not exist, it will add the specified
            key with the specified value</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$unset</span></td>
          <td class="col2-c2-odd">Removes the specified key from the existing document</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$rename</span></td>
          <td class="col2-c2-even">Renames an existing key to the specified key</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$push</span></td>
          <td class="col2-c2-odd">Appends the specified value into the specified array (even if the value already exists). If the
            specified key is not present in the document, it adds the array field with the value as its element</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$addToSet</span></td>
          <td class="col2-c2-even">Appends the specified value into the specified array only if the value does not already exist in
            the array</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$pop</span></td>
          <td class="col2-c2-odd">Removes the last or first item of the specified array. A value of 1 indicates last while a value
            of -1 indicates the first</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$pull</span></td>
          <td class="col2-c2-even">Removes all occurences of the specified value from the specified array</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$pullAll</span></td>
          <td class="col2-c2-odd">Removes multiple specified values from the specified array</td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>To query the value of <span class="bold">quantity</span> from the collection <span class="bold">products</span> with
        <span class="bold">_id</span> of <span class="bold">7_habits</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': '7_habits' }, { 'quantity': 1, '_id': 0 })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.22</h4>
      <pre>{ "quantity" : 11 }</pre>
    </div>
    <div id="para-div">
      <p>To increment the <span class="bold">quantity</span> in the collection <span class="bold">products</span> for the
        <span class="bold">_id</span> of <span class="bold">7_habits</span> by a value of <span class="bold">2</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.update({ '_id': '7_habits' }, { '$inc': { 'quantity': 2 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.23</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now, re-execute the query for the value of <span class="bold">quantity</span> from the collection <span class="bold">products
        </span> for the <span class="bold">_id</span> of <span class="bold">7_habits</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': '7_habits' }, { 'quantity': 1, '_id': 0 })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.24</h4>
      <pre>{ "quantity" : 13 }</pre>
    </div>
    <div id="para-div">
      <p>To decrement the <span class="bold">quantity</span> in the collection <span class="bold">products</span> for the
        <span class="bold">_id</span> of <span class="bold">7_habits</span> by a value of <span class="bold">4</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.update({ '_id': '7_habits' }, { '$inc': { 'quantity': -4 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.25</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now again re-execute the query for the value of <span class="bold">quantity</span> from the collection <span class="bold">
        products</span> for the <span class="bold">_id</span> of <span class="bold">7_habits</span> by executing the following
        command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': '7_habits' }, { 'quantity': 1, '_id': 0 })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.26</h4>
      <pre>{ "quantity" : 9 }</pre>
    </div>
    <div id="para-div">
      <p>To set the value of <span class="bold">quantity</span> in the collection <span class="bold">products</span> for the
        <span class="bold">_id</span> of <span class="bold">7_habits</span> to a value of <span class="bold">10</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.update({ '_id': '7_habits' }, { '$set': { 'quantity': 10 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.27</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now query the value of <span class="bold">quantity</span> from the collection <span class="bold">products</span> for the
        <span class="bold">_id</span> of <span class="bold">7_habits</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': '7_habits' }, { 'quantity': 1, '_id': 0 })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.28</h4>
      <pre>{ "quantity" : 10 }</pre>
    </div>
    <div id="para-div">
      <p>To query the document from the collection <span class="bold">users</span> for the <span class="bold">_id</span> of
        <span class="bold">bob</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.findOne({ '_id': 'bob' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.29</h4>
      <pre>{
  "_id" : "bob",
  "first" : "Bob",
  "last" : "Jones",
  "contact" : {
    "email" : "bob.jones@tall.com",
    "phone" : "987-654-3210",
    "zip" : "10002"
  }
}</pre>
    </div>
    <div id="para-div">
      <p>Now to set the value of <span class="bold">middle</span> (a new key) in the collection <span class="bold">users</span> for
        the <span class="bold">_id</span> of <span class="bold">bob</span> with a value of <span class="bold">C</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.update({ '_id': 'bob' }, { '$set': { 'middle': 'C' }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.30</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now, again query the document from the collection <span class="bold">users</span> for the <span class="bold">_id</span> of
        <span class="bold">bob</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.findOne({ '_id': 'bob' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.31</h4>
      <pre>{
  "_id" : "bob",
  "first" : "Bob",
  "last" : "Jones",
  "contact" : {
    "email" : "bob.jones@tall.com",
    "phone" : "987-654-3210",
    "zip" : "10002"
  },
  "middle" : "C"
}</pre>
    </div>
    <div id="para-div">
      <p>As is evident from the Output.31 above, the key <span class="bold">middle</span> with a value of <span class="bold">C</span>
        has been added to the document.</p>
    </div>
    <div id="para-div">
      <p>To remove the key <span class="bold">middle</span> from the collection <span class="bold">users</span> for the <span class="bold">
        _id</span> of <span class="bold">bob</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.update({ '_id': 'bob' }, { '$unset': { 'middle': 1 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.32</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now query the document from the collection <span class="bold">users</span> for the <span class="bold">_id</span> of
        <span class="bold">bob</span> by  executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.users.findOne({ '_id': 'bob' })</p>
    </div>
    <div id="para-div">
      <p>The output will be similar to the one in Output.29 above.</p>
    </div>
    <div id="para-div">
      <p>As is evident from the Output.29 above, the key <span class="bold">middle</span> has been deleted from the document.</p>
    </div>
    <div id="para-div">
      <p>To query the document from the collection <span class="bold">products</span> for the <span class="bold">_id</span> of
        <span class="bold">ipad_air3_64</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': 'ipad_air3_64' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.33</h4>
      <pre>{
  "_id" : "ipad_air3_64",
  "name" : "Apple iPad Air 3rd Gen 64G Wifi",
  "price" : 599,
  "quantity" : 5,
  "category" : [
    "electronics",
    "tablet",
    "apple"
  ]
}</pre>
    </div>
    <div id="para-div">
      <p>To append the value <span class="bold">ipad</span> to the array of <span class="bold">category</span> in the collection
        <span class="bold">products</span> for the <span class="bold">_id</span> of <span class="bold">ipad_air3_64</span>, execute
        the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.update({ '_id': 'ipad_air3_64' }, { '$push': { 'category': 'ipad' }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.34</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now again query the document from the collection <span class="bold">products</span> for the <span class="bold">_id</span>
        of <span class="bold">ipad_air3_64</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': 'ipad_air3_64' })</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.35</h4>
      <pre>{
  "_id" : "ipad_air3_64",
  "name" : "Apple iPad Air 3rd Gen 64G Wifi",
  "price" : 599,
  "quantity" : 5,
  "category" : [
    "electronics",
    "tablet",
    "apple",
    "ipad"
  ]
}</pre>
    </div>
    <div id="para-div">
      <p>To remove the value <span class="bold">ipad</span> from the array of <span class="bold">category</span> in the collection
        <span class="bold">products</span> for the <span class="bold">_id</span> of <span class="bold">ipad_air_32</span>, execute
        the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.update({ '_id': 'ipad_air3_64' }, { '$pop': { 'category': 1 }})</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.36</h4>
      <pre>WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })</pre>
    </div>
    <div id="para-div">
      <p>Now re-query the document from the collection <span class="bold">products</span> for the <span class="bold">_id</span> of
        <span class="bold">ipad_air3_64</span> by executing the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.findOne({ '_id': 'ipad_air3_64' })</p>
    </div>
    <div id="para-div">
      <p>The output will be similar to the one in Output.33 above.</p>
    </div>
    <div id="para-div">
      <p>The MongoDB <span class="bold">Aggregation Framework</span> (using the <span class="hi-yellow">aggregate()</span> operation)
        allows one to perform a pipeline of operations (such as matching, grouping, and transformations) on multiple documents in a
        collection to produce the desired aggregated results. This is similar to the <span class="bold">GROUP BY</span> operations
        in the relational world.</p>
    </div>
    <div id="para-div">
      <p>The following are some of the pipeline operators that can be used for performing the aggregation operation on a collection:</p>
    </div>
    <table id="col2-table">
      <thead>
        <tr>
          <th>Aggregate Operator</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$match</span></td>
          <td class="col2-c2-odd">Allows one to select a set of documents from a collection based on a criteria</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$group</span></td>
          <td class="col2-c2-even">Allows one to perform an aggregation operation on all documents in the collection such as counts,
            averages, maximums, or minimums</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$sort</span></td>
          <td class="col2-c2-odd">Allows one to sort the documents from the collection based on the specified field(s)</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$unwind</span></td>
          <td class="col2-c2-even">Applies to an array field in a document and splits each array element as a new document (only in
            memory)</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$project</span></td>
          <td class="col2-c2-odd">Allows one select specified field(s) from the documents in the collection</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$limit</span></td>
          <td class="col2-c2-even">Allows one to limit the number of the documents returned in the result</td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>To select all the documents from the collection <span class="bold">reviews</span> where the field <span class="bold">user_id
        </span> has a value of <span class="bold">frank</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $match: { user_id: 'frank' } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.37</h4>
      <pre>{ "_id" : ObjectId("602a7b9cca9f13844ae66947"), "user_id" : "frank", "product_id" : "canon_r5", "created" : ISODate("2020-08-29T00:00:00Z"), "rating" : 4, "comments" : "Good Mirrorless but pricy" }
{ "_id" : ObjectId("602a7b9cca9f13844ae66948"), "user_id" : "frank", "product_id" : "iwatch_6_44", "created" : ISODate("2020-07-05T00:00:00Z"), "rating" : 5, "comments" : "Excellent wearable", "recommend" : "yes" }
{ "_id" : ObjectId("602a7b9cca9f13844ae66949"), "user_id" : "frank", "product_id" : "mongo_action", "created" : ISODate("2019-12-04T00:00:00Z"), "rating" : 3, "comments" : "Decent book" }</pre>
    </div>
    <div id="para-div">
      <p>To unwind and split each of the documents from the collection <span class="bold">reviews</span> based on each of the
        elements in the array field <span class="bold">category</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.aggregate([{ $unwind: '$category' }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.38</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "electronics" }
{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "tablet" }
{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "apple" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "electronics" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "tablet" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "amazon" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "electronics" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "wearable" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "apple" }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : "electronics" }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : "camera" }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : "mirrorless" }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : "nikon" }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : "electronics" }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : "camera" }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : "mirrorless" }
{ "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : "canon" }
{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : "books" }
{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : "technology" }
{ "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : "oreilly" }
Type "it" for more</pre>
    </div>
    <div id="para-div">
      <p>To unwind and split each of the documents from the collection <span class="bold">reviews</span> based on each of the
        elements in the array field <span class="bold">category</span> and limit the results to 10 documents, execute the following
        command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.aggregate([{ $unwind: '$category' }, { $limit: 10}])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.39</h4>
      <pre>{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "electronics" }
{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "tablet" }
{ "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : "apple" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "electronics" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "tablet" }
{ "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : "amazon" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "electronics" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "wearable" }
{ "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : "apple" }
{ "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : "electronics" }</pre>
    </div>
    <div id="para-div">
      <p><span class="underbold">NOTICE</span> how the pipeline operators <span class="bold">$unwind</span> and <span class="bold">
        $limit</span> are piped together as a sequence of arguments to the <span class="bold">aggregate()</span> operator to form
        the data processing pipeline. Each of the operators in the pipeline are referred to as a <span class="hi-yellow">Stage</span>.</p>
    </div>
    <div id="para-div">
      <p>The following are some of the operators that can be used with the <span class="bold">$group</span> pipeline operator for
        performing the group operations on a collection:</p>
    </div>
    <table id="col2-table">
      <thead>
        <tr>
          <th>Aggregate Operator</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$avg</span></td>
          <td class="col2-c2-odd">Computes the average for the values of the specified key from all documents in the collection</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$max</span></td>
          <td class="col2-c2-even">Finds the maximum of the values for the specified key from all documents in the collection</td>
        </tr>
        <tr>
          <td class="col2-c1-odd"><span class="bold">$min</span></td>
          <td class="col2-c2-odd">Finds the minimum of the values for the specified key from all documents in the collection</td>
        </tr>
        <tr>
          <td class="col2-c1-even"><span class="bold">$sum</span></td>
          <td class="col2-c2-even">Adds the specified value for all documents in the collection</td>
        </tr>
      </tbody>
    </table>
    <div id="para-div">
      <p>To query the number of reviews grouped by each <span class="bold">user_id</span> from the collection <span class="bold">
        reviews</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $group : { _id : '$user_id', num_reviews : { $sum : 1 } } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.40</h4>
      <pre>{ "_id" : "charlie", "num_reviews" : 2 }
{ "_id" : "george", "num_reviews" : 1 }
{ "_id" : "alice", "num_reviews" : 3 }
{ "_id" : "bob", "num_reviews" : 2 }
{ "_id" : "frank", "num_reviews" : 3 }</pre>
    </div>
    <div id="para-div">
      <p>To query the number of reviews grouped by each <span class="bold">user_id</span> from the collection <span class="bold">
        reviews</span> and return the results in a descending sorted order by the number of reviews, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $group : { _id : '$user_id', num_reviews : { $sum : 1 } } }, { $sort: { num_reviews: -1 } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.41</h4>
      <pre>{ "_id" : "alice", "num_reviews" : 3 }
{ "_id" : "frank", "num_reviews" : 3 }
{ "_id" : "charlie", "num_reviews" : 2 }
{ "_id" : "bob", "num_reviews" : 2 }
{ "_id" : "george", "num_reviews" : 1 }</pre>
    </div>
    <div id="para-div">
      <p>To query the number of items in the <span class="bold">category</span> of <span class="bold">books</span> from the collection
        <span class="bold">products</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.aggregate([{ $match: { category: 'books' } }, { $group : { _id : '$category', count : { $sum : 1 } } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.42</h4>
      <pre>{ "_id" : [ "books", "technology", "oreilly" ], "count" : 1 }
{ "_id" : [ "books", "audiobook", "business", "leadership" ], "count" : 1 }
{ "_id" : [ "books", "technology", "manning" ], "count" : 1 }
{ "_id" : [ "books", "business", "self-help" ], "count" : 1 }</pre>
    </div>
    <div id="para-div">
      <p><span class="bold">Hmmm</span> - this is not what we expected. Now we see why we need the <span class="bold">$unwind</span>
        operator !!!</p>
    </div>
    <div id="para-div">
      <p>To query the number of items in the <span class="bold">category</span> of <span class="bold">books</span> from the collection
        <span class="bold">products</span> the correct way, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.products.aggregate([{ $unwind: '$category' }, { $match: { category: 'books' } }, { $group : { _id : '$category', count : { $sum : 1 } } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.43</h4>
      <pre>{ "_id" : "books", "count" : 4 }</pre>
    </div>
    <div id="para-div">
      <p>To query the average rating grouped by each <span class="bold">product_id</span> from the collection <span class="bold">
        reviews</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{$group : {_id : '$product_id', average_rating : {$avg : '$rating'}}}])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.44</h4>
      <pre>{ "_id" : "my_cheese", "average_rating" : 3.5 }
{ "_id" : "mongo_def", "average_rating" : 5 }
{ "_id" : "kindle_hdx_32", "average_rating" : 5 }
{ "_id" : "7_habits", "average_rating" : 5 }
{ "_id" : "mongo_action", "average_rating" : 3 }
{ "_id" : "ipad_air3_64", "average_rating" : 5 }
{ "_id" : "nikon_z6", "average_rating" : 4 }
{ "_id" : "iwatch_6_44", "average_rating" : 5 }
{ "_id" : "canon_r5", "average_rating" : 4 }</pre>
    </div>
    <div id="para-div">
      <p>To select only the fields <span class="bold">product_id</span> and <span class="bold">rating</span> from all the documents
        in the collection <span class="bold">reviews</span> where the field <span class="bold">user_id</span> has a value of
        <span class="bold">frank</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $match: { user_id: 'frank' } }, { $project: { user_id: 1, product_id: 1, rating: 1 } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.45</h4>
      <pre>{ "_id" : ObjectId("602a7b9cca9f13844ae66947"), "user_id" : "frank", "product_id" : "canon_r5", "rating" : 4 }
{ "_id" : ObjectId("602a7b9cca9f13844ae66948"), "user_id" : "frank", "product_id" : "iwatch_6_44", "rating" : 5 }
{ "_id" : ObjectId("602a7b9cca9f13844ae66949"), "user_id" : "frank", "product_id" : "mongo_action", "rating" : 3 }</pre>
    </div>
    <div id="para-div">
      <p>To query the number of reviews grouped by the <span class="bold">user_id</span> with a value of <span class="bold">frank
        </span> from the collection <span class="bold">reviews</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $match: { user_id: 'frank' } }, { $project: { user_id: 1, product_id: 1, rating: 1 } }, { $group : { _id : '$user_id', num_reviews : { $sum : 1 } } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.46</h4>
      <pre>{ "_id" : "frank", "num_reviews" : 3 }</pre>
    </div>
    <div id="para-div">
      <p>Each of the document in the collection <span class="bold">reviews</span> has two references - one to a document in the
        collection <span class="bold">products</span> via the field <span class="bold">product_id</span> and the other to a document
        in the collection <span class="bold">users</span> via the field <span class="bold">user_id</span>. One can explicitly write
        logic to join the two collections or one can use the <span class="hi-yellow">$lookup</span> pipeline operator to implicitly
        join the two collections.</p>
    </div>
    <div id="para-div">
      <p>The general format of the <span class="bold">$lookup</span> operator is as follows:</p>
      <p>&nbsp;&nbsp;{</p>
      <p>&nbsp;&nbsp;&nbsp;&nbsp;<span class="bold">from:</span> 'collection to join with'</p>
      <p>&nbsp;&nbsp;&nbsp;&nbsp;<span class="bold">localField:</span> 'field from the current input document'</p>
      <p>&nbsp;&nbsp;&nbsp;&nbsp;<span class="bold">foreignField:</span> 'field in the <span class="bold">from:</span> collection'</p>
      <p>&nbsp;&nbsp;&nbsp;&nbsp;<span class="bold">as:</span> 'output array field'</p>
      <p>&nbsp;&nbsp;}</p>
    </div>
    <div id="para-div">
      <p>The result of the <span class="bold">$lookup</span> operation is that the document in the <span class="bold">from:</span>
        collection is embedded (or joined) into the current input document.</p>
    </div>
    <div id="para-div">
      <p>To join and embed each user from the collection <span class="bold">users</span> that corresponds to the <span class="bold">
        user_id</span> into the documents from the collection <span class="bold">reviews</span>, execute the following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $lookup: { from: 'users', localField: 'user_id', foreignField: '_id', as: 'user' } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.47</h4>
      <pre>{ "_id" : ObjectId("602a7b9cca9f13844ae66940"), "user_id" : "alice", "product_id" : "nikon_z6", "created" : ISODate("2020-07-15T00:00:00Z"), "rating" : 4, "comments" : "Good mirrorless", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66941"), "user_id" : "alice", "product_id" : "mongo_def", "created" : ISODate("2018-04-11T00:00:00Z"), "rating" : 5, "comments" : "Great book on Mongo", "recommend" : "yes", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66942"), "user_id" : "alice", "product_id" : "my_cheese", "created" : ISODate("2018-08-14T00:00:00Z"), "rating" : 4, "comments" : "Decent book with moral", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66943"), "user_id" : "bob", "product_id" : "ipad_air3_64", "created" : ISODate("2020-05-09T00:00:00Z"), "rating" : 5, "comments" : "The best tablet in the market", "user" : [ { "_id" : "bob", "first" : "Bob", "last" : "Jones", "contact" : { "email" : "bob.jones@tall.com", "phone" : "987-654-3210", "zip" : "10002" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66944"), "user_id" : "bob", "product_id" : "iwatch_6_44", "created" : ISODate("2020-11-19T00:00:00Z"), "rating" : 5, "comments" : "Love this iWatch", "user" : [ { "_id" : "bob", "first" : "Bob", "last" : "Jones", "contact" : { "email" : "bob.jones@tall.com", "phone" : "987-654-3210", "zip" : "10002" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66945"), "user_id" : "charlie", "product_id" : "7_habits", "created" : ISODate("2019-06-27T00:00:00Z"), "rating" : 5, "comments" : "Excellent leadership book", "user" : [ { "_id" : "charlie", "first" : "Charlie", "last" : "Lee", "contact" : { "email" : "c_lee@hard.com", "phone" : "234-567-8901", "zip" : "10003" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66946"), "user_id" : "charlie", "product_id" : "my_cheese", "created" : ISODate("2018-11-24T00:00:00Z"), "rating" : 3, "comments" : "An ok book for reading", "user" : [ { "_id" : "charlie", "first" : "Charlie", "last" : "Lee", "contact" : { "email" : "c_lee@hard.com", "phone" : "234-567-8901", "zip" : "10003" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66947"), "user_id" : "frank", "product_id" : "canon_r5", "created" : ISODate("2020-08-29T00:00:00Z"), "rating" : 4, "comments" : "Good Mirrorless but pricy", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66948"), "user_id" : "frank", "product_id" : "iwatch_6_44", "created" : ISODate("2020-07-05T00:00:00Z"), "rating" : 5, "comments" : "Excellent wearable", "recommend" : "yes", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66949"), "user_id" : "frank", "product_id" : "mongo_action", "created" : ISODate("2019-12-04T00:00:00Z"), "rating" : 3, "comments" : "Decent book", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae6694a"), "user_id" : "george", "product_id" : "kindle_hdx_32", "created" : ISODate("2018-09-20T00:00:00Z"), "rating" : 5, "comments" : "Great ebook reader from Amazon", "user" : [ { "_id" : "george", "first" : "George", "last" : "Baker", "contact" : { "email" : "g_baker@sharp.com", "phone" : "123-654-0987", "zip" : "10001" } } ] }</pre>
    </div>
    <div id="para-div">
      <p>To join and embed each user from the collection <span class="bold">users</span> that corresponds to the <span class="bold">
        user_id</span> as well as the product from the collection <span class="bold">products</span> that corresponds to the
        <span class="bold">product_id</span> into the documents from the collection <span class="bold">reviews</span>, execute the
        following command:</p>
    </div>
    <div id="cmd-div">
      <p>mongodb-rs:PRIMARY&gt; db.reviews.aggregate([{ $lookup: { from: 'users', localField: 'user_id', foreignField: '_id', as: 'user' } }, { $lookup: { from: 'products', localField: 'product_id', foreignField: '_id', as: 'product' } }])</p>
    </div>
    <div id="para-div">
      <p>The following will be the typical output:</p>
    </div>
    <div id="out-div">
      <h4>Output.48</h4>
      <pre>{ "_id" : ObjectId("602a7b9cca9f13844ae66940"), "user_id" : "alice", "product_id" : "nikon_z6", "created" : ISODate("2020-07-15T00:00:00Z"), "rating" : 4, "comments" : "Good mirrorless", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ], "product" : [ { "_id" : "nikon_z6", "name" : "Nikon Z6", "price" : 1299, "quantity" : 3, "category" : [ "electronics", "camera", "mirrorless", "nikon" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66941"), "user_id" : "alice", "product_id" : "mongo_def", "created" : ISODate("2018-04-11T00:00:00Z"), "rating" : 5, "comments" : "Great book on Mongo", "recommend" : "yes", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ], "product" : [ { "_id" : "mongo_def", "name" : "MongoDB, The Definitive Guide", "price" : 39.99, "quantity" : 9, "category" : [ "books", "technology", "oreilly" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66942"), "user_id" : "alice", "product_id" : "my_cheese", "created" : ISODate("2018-08-14T00:00:00Z"), "rating" : 4, "comments" : "Decent book with moral", "user" : [ { "_id" : "alice", "first" : "Alice", "last" : "Thompson", "contact" : { "email" : "alicet@smart.com", "phone" : "123-456-7890", "zip" : "10001" } } ], "product" : [ { "_id" : "my_cheese", "name" : "Who Moved My Cheese", "price" : 8.99, "quantity" : 4, "category" : [ "books", "business", "self-help" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66943"), "user_id" : "bob", "product_id" : "ipad_air3_64", "created" : ISODate("2020-05-09T00:00:00Z"), "rating" : 5, "comments" : "The best tablet in the market", "user" : [ { "_id" : "bob", "first" : "Bob", "last" : "Jones", "contact" : { "email" : "bob.jones@tall.com", "phone" : "987-654-3210", "zip" : "10002" } } ], "product" : [ { "_id" : "ipad_air3_64", "name" : "Apple iPad Air 3rd Gen 64G Wifi", "price" : 599, "quantity" : 5, "category" : [ "electronics", "tablet", "apple" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66944"), "user_id" : "bob", "product_id" : "iwatch_6_44", "created" : ISODate("2020-11-19T00:00:00Z"), "rating" : 5, "comments" : "Love this iWatch", "user" : [ { "_id" : "bob", "first" : "Bob", "last" : "Jones", "contact" : { "email" : "bob.jones@tall.com", "phone" : "987-654-3210", "zip" : "10002" } } ], "product" : [ { "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66945"), "user_id" : "charlie", "product_id" : "7_habits", "created" : ISODate("2019-06-27T00:00:00Z"), "rating" : 5, "comments" : "Excellent leadership book", "user" : [ { "_id" : "charlie", "first" : "Charlie", "last" : "Lee", "contact" : { "email" : "c_lee@hard.com", "phone" : "234-567-8901", "zip" : "10003" } } ], "product" : [ { "_id" : "7_habits", "name" : "The 7 Habits of Highly Effective People", "price" : 19.99, "quantity" : 11, "category" : [ "books", "audiobook", "business", "leadership" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66946"), "user_id" : "charlie", "product_id" : "my_cheese", "created" : ISODate("2018-11-24T00:00:00Z"), "rating" : 3, "comments" : "An ok book for reading", "user" : [ { "_id" : "charlie", "first" : "Charlie", "last" : "Lee", "contact" : { "email" : "c_lee@hard.com", "phone" : "234-567-8901", "zip" : "10003" } } ], "product" : [ { "_id" : "my_cheese", "name" : "Who Moved My Cheese", "price" : 8.99, "quantity" : 4, "category" : [ "books", "business", "self-help" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66947"), "user_id" : "frank", "product_id" : "canon_r5", "created" : ISODate("2020-08-29T00:00:00Z"), "rating" : 4, "comments" : "Good Mirrorless but pricy", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ], "product" : [ { "_id" : "canon_r5", "name" : "Canon R5", "price" : 3899, "quantity" : 5, "category" : [ "electronics", "camera", "mirrorless", "canon" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66948"), "user_id" : "frank", "product_id" : "iwatch_6_44", "created" : ISODate("2020-07-05T00:00:00Z"), "rating" : 5, "comments" : "Excellent wearable", "recommend" : "yes", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ], "product" : [ { "_id" : "iwatch_6_44", "name" : "Apple iWatch 6 Wifi 44mm", "price" : 899, "quantity" : 8, "category" : [ "electronics", "wearable", "apple" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae66949"), "user_id" : "frank", "product_id" : "mongo_action", "created" : ISODate("2019-12-04T00:00:00Z"), "rating" : 3, "comments" : "Decent book", "user" : [ { "_id" : "frank", "first" : "Frank", "last" : "Smith", "contact" : { "email" : "fsmith@doe.com", "phone" : "987-456-1111", "zip" : "10002" } } ], "product" : [ { "_id" : "mongo_action", "name" : "MongoDB in Action", "price" : 49.99, "quantity" : 6, "category" : [ "books", "technology", "manning" ] } ] }
{ "_id" : ObjectId("602a7b9cca9f13844ae6694a"), "user_id" : "george", "product_id" : "kindle_hdx_32", "created" : ISODate("2018-09-20T00:00:00Z"), "rating" : 5, "comments" : "Great ebook reader from Amazon", "user" : [ { "_id" : "george", "first" : "George", "last" : "Baker", "contact" : { "email" : "g_baker@sharp.com", "phone" : "123-654-0987", "zip" : "10001" } } ], "product" : [ { "_id" : "kindle_hdx_32", "name" : "Amazon Kindle 8.9 HDX 32G Wifi", "price" : 99, "quantity" : 6, "category" : [ "electronics", "tablet", "amazon" ] } ] }</pre>
    </div>
    <br/>
    <div id="section-div">
      <p>References</p>
    </div>
    <div id="para-div">
      <p><a href="https://polarsparc.github.io/MongoDB/MongoDB-1.html" target="_blank"><span class="bold">Hands-on MongoDB :: Part-1</span></a></p>
      <p><a href="https://polarsparc.github.io/MongoDB/MongoDB-2.html" target="_blank"><span class="bold">Hands-on MongoDB :: Part-2</span></a></p>
      <p><a href="https://polarsparc.github.io/MongoDB/MongoDB-3.html" target="_blank"><span class="bold">Hands-on MongoDB :: Part-3</span></a></p>
      <p><a href="https://docs.mongodb.com/manual/" target="_blank"><span class="bold">MongoDB Manual</span></a></p>
    </div>
    <br/>
    <hr class="line-hr" />
    <div>
      <a id="footer-a" href="https://polarsparc.github.io/">&copy;&nbsp;PolarSPARC</a>
    </div>
  </body>
</html>
